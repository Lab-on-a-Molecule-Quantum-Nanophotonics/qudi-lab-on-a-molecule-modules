<!DOCTYPE html>
<html  lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1"><meta name="viewport" content="width=device-width, initial-scale=1" />

      <title>Introduction to a crash course into Qudi</title>
    
          <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
          <link rel="stylesheet" href="_static/theme.css " type="text/css" />
          <link rel="stylesheet" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" type="text/css" />
          <link rel="stylesheet" href="_static/exercise.css" type="text/css" />
      
      <!-- sphinx script_files -->
        <script src="_static/documentation_options.js?v=5929fcd5"></script>
        <script src="_static/doctools.js?v=9bcbadda"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>

      
      <!-- bundled in js (rollup iife) -->
      <!-- <script src="_static/theme-vendors.js"></script> -->
      <script src="_static/theme.js" defer></script>
    
      <link rel="shortcut icon" href="_static/logo.png"/>
  <link rel="index" title="Index" href="genindex.html" />
  <link rel="search" title="Search" href="search.html" />
  <link rel="next" title="Guide: performing excitation spectroscopy" href="guides/excitation-spectroscopy.html" />
  <link rel="prev" title="Qudi Lab on a Molecule Modules documentation" href="index.html" /> 
  </head>

  <body>
    <div id="app">
    <div class="theme-container" :class="pageClasses"><navbar @toggle-sidebar="toggleSidebar">
  <router-link to="index.html" class="home-link">
    
      <span class="site-name">Qudi Lab on a molecule modules</span>
    
  </router-link>

  <div class="links">
    <navlinks class="can-hide">

  
    <div class="nav-item">
      <a href="index.html#qudi-lab-on-a-molecule-modules-documentation"
         class="nav-link  router-link-active">
         Tutorials:
      </a>
    </div>
  
    <div class="nav-item">
      <a href="index.html#qudi-lab-on-a-molecule-modules-documentation"
         class="nav-link ">
         Contents:
      </a>
    </div>
  



    </navlinks>
  </div>
</navbar>

      
      <div class="sidebar-mask" @click="toggleSidebar(false)">
      </div>
        <sidebar @toggle-sidebar="toggleSidebar">
          
          <navlinks>
            

  
    <div class="nav-item">
      <a href="index.html#qudi-lab-on-a-molecule-modules-documentation"
         class="nav-link  router-link-active">
         Tutorials:
      </a>
    </div>
  
    <div class="nav-item">
      <a href="index.html#qudi-lab-on-a-molecule-modules-documentation"
         class="nav-link ">
         Contents:
      </a>
    </div>
  



            
          </navlinks><div id="searchbox" class="searchbox" role="search">
  <div class="caption"><span class="caption-text">Quick search</span>
    <div class="searchformwrapper">
      <form class="search" action="search.html" method="get">
        <input type="text" name="q" />
        <input type="submit" value="Search" />
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
      </form>
    </div>
  </div>
</div><div class="sidebar-links" role="navigation" aria-label="main navigation">
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="index.html#qudi-lab-on-a-molecule-modules-documentation">Tutorials:</a></span>
      </p>
      <ul class="current">
        
          <li class="toctree-l1 current">
            
              <a href="#" class="reference internal current">    Tutorial: a crash course into Qudi</a>
            

            
              <ul>
                
                  <li class="toctree-l2"><a href="#introduction-to-a-crash-course-into-qudi" class="reference internal">Introduction to a crash course into Qudi</a></li>
                
                  <li class="toctree-l2"><a href="#before-the-lecture" class="reference internal">Before the lecture</a></li>
                
                  <li class="toctree-l2"><a href="#at-the-beginning-of-the-lecture" class="reference internal">At the beginning of the lecture</a></li>
                
                  <li class="toctree-l2"><a href="#a-crash-course-into-qudi" class="reference internal">A crash course into Qudi</a></li>
                
                  <li class="toctree-l2"><a href="#hello-qudi" class="reference internal">Hello, Qudi!</a></li>
                
                  <li class="toctree-l2"><a href="#basics-of-qudi" class="reference internal">Basics of Qudi</a></li>
                
                  <li class="toctree-l2"><a href="#when-things-go-wrong-understanding-errors" class="reference internal">When things go wrong: understanding errors</a></li>
                
                  <li class="toctree-l2"><a href="#interactive-activity-let-s-write-a-logic-module" class="reference internal">Interactive activity: let’s write a logic module</a></li>
                
                  <li class="toctree-l2"><a href="#the-modules-we-commonly-use" class="reference internal">The modules we commonly use</a></li>
                
                  <li class="toctree-l2"><a href="#pulsers" class="reference internal">Pulsers</a></li>
                
                  <li class="toctree-l2"><a href="#concluding-remarks" class="reference internal">Concluding remarks</a></li>
                
              </ul>
            
          </li>

        
          <li class="toctree-l1 ">
            
              <a href="guides/excitation-spectroscopy.html" class="reference internal ">    Guide: Excitation spectroscopy</a>
            

            
          </li>

        
          <li class="toctree-l1 ">
            
              <a href="guides/state-machines.html" class="reference internal ">    Guide: State machines</a>
            

            
          </li>

        
          <li class="toctree-l1 ">
            
              <a href="iqo-docs/setup_confocal_scanning.html" class="reference internal ">    Guide: Setting up confocal scanning</a>
            

            
          </li>

        
          <li class="toctree-l1 ">
            
              <a href="iqo-docs/setup_odmr.html" class="reference internal ">    Guide: Setting up ODMR</a>
            

            
          </li>

        
          <li class="toctree-l1 ">
            
              <a href="iqo-docs/setup_timeseries.html" class="reference internal ">    Guide: Setting up time series</a>
            

            
          </li>

        
      </ul>
    </div>
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="index.html#qudi-lab-on-a-molecule-modules-documentation">Contents:</a></span>
      </p>
      <ul class="">
        
          <li class="toctree-l1 ">
            
              <a href="installation.html" class="reference internal ">Installation</a>
            

            
          </li>

        
          <li class="toctree-l1 ">
            
              <a href="changelog-lens.html" class="reference internal ">Lens's changelog</a>
            

            
          </li>

        
          <li class="toctree-l1 ">
            
              <a href="modules/index.html" class="reference internal ">Documentation of all modules</a>
            

            
          </li>

        
          <li class="toctree-l1 ">
            
              <a href="iqo-docs/changelog.html" class="reference internal ">Ulm IQO's changelog (parent repository)</a>
            

            
          </li>

        
          <li class="toctree-l1 ">
            
              <a href="programming-guides.html" class="reference internal ">Programming guides: writing your own modules and understanding our hardwares.</a>
            

            
          </li>

        
          <li class="toctree-l1 ">
            
              <a href="iqo-docs/iqo-specifics.html" class="reference internal ">Ulm IQO's specific guides</a>
            

            
          </li>

        
      </ul>
    </div>
  
</div>
        </sidebar>

      <page>
          <div class="body-header" role="navigation" aria-label="navigation">
  
  <ul class="breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
    
    <li>Introduction to a crash course into Qudi</li>
  </ul>
  

  <ul class="page-nav">
  <li class="prev">
    <a href="index.html"
       title="previous chapter">← Qudi Lab on a Molecule Modules documentation</a>
  </li>
  <li class="next">
    <a href="guides/excitation-spectroscopy.html"
       title="next chapter">Guide: performing excitation spectroscopy →</a>
  </li>
</ul>
  
</div>
<hr>
          <div class="content" role="main" v-pre>
            
  <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
<section id="introduction-to-a-crash-course-into-qudi">
<h1>Introduction to a crash course into Qudi<a class="headerlink" href="#introduction-to-a-crash-course-into-qudi" title="Link to this heading">¶</a></h1>
<p>These lecture notes were written by Hugo Levy-Falk (CNR-INO). The goal is to get people to become familiar with Qudi, the Python framework we use in <a class="reference external" href="https://quantumnanophotonics-lab.ino.cnr.it/">the Molecular Quantum Photonics group in LENS</a> to automate and control our experiments. This lecture is primarily targeted at members of the group, but is built such that it starts with a very general scope and focuses more and more on the specific modules we use. As such, it should be useful to anyone interested in the topic of experiments automations using Qudi, and you should be able to leave as soon as things gets too specific for your applications.</p>
<p>This is an <strong>interactive lecture</strong>. This means that people are expected to download Qudi and run this notebook on their computer. The “<a class="reference internal" href="#before-the-lecture"><span class="std std-ref">Before the lecture</span></a>” section covers the pre-requisites to follow the lecture and the installation of Qudi on your computer. The actual lecture is in the “<a class="reference internal" href="#a-crash-course-into-qudi"><span class="std std-ref">A crash course into Qudi</span></a>” section.</p>
</section>
<section id="before-the-lecture">
<span id="id1"></span><h1>Before the lecture<a class="headerlink" href="#before-the-lecture" title="Link to this heading">¶</a></h1>
<p>This is a Jupyter notebook that we will use to discover the basics about Qudi, the Python framework we use to control and automate our setups. Before the lecture, I would like you to read this first section to prepare your computer so that you can follow it interactively.</p>
<section id="you-need-to-know">
<h2>You need to know<a class="headerlink" href="#you-need-to-know" title="Link to this heading">¶</a></h2>
<p>It helps a lot to be familiar with some tools:</p>
<ul class="simple">
<li><p>YAML (YAML Ain’t Markup Language), you can read <a class="reference external" href="https://learnxinyminutes.com/yaml/">this guide</a></p></li>
<li><p>Python. You can get a refresher here in <a class="reference external" href="https://learnxinyminutes.com/python/">this short guide</a>. In particular, I want you to be familiar with the idea of classes and objects in addition to the standard programming statements. It is useful to have the <a class="reference external" href="https://docs.python.org/3/">official documentation</a> at hand. If you need a more in-depth introduction, read the <a class="reference external" href="https://docs.python.org/3/tutorial/index.html">official python tutorial</a>. There’s also <a class="reference external" href="https://wiki.python.org/moin/BeginnersGuide">the beginner’s guide to python</a> for people lacking programming experience.</p></li>
</ul>
</section>
<section id="what-i-want-you-to-install-and-download">
<h2>What I want you to install and download<a class="headerlink" href="#what-i-want-you-to-install-and-download" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>We use the <code class="docutils literal notranslate"><span class="pre">uv</span></code> package manager. Please read and follow the <a class="reference external" href="https://docs.astral.sh/uv/getting-started/">getting started</a> guide. <strong>Ask me for help if you are struggling.</strong></p></li>
<li><p>We will need <code class="docutils literal notranslate"><span class="pre">git</span></code>. This is a version control system (a tool to work collaboratively on code. For example, this is the tool behind <a class="reference external" href="https://github.com">GitHub</a>). Explaining this tool is out of scope, please <a class="reference external" href="https://git-scm.com/install/">install it</a>. If you want to learn more, you might read <a class="reference external" href="https://learnxinyminutes.com/git/">this short guide</a> or look for a more extensive tutorial.</p></li>
<li><p>A text editor. In theory the simplest notepad is enough, but you may find more advanced applications useful. If you just need somethin lightwight, you can use <a class="reference external" href="https://notepad-plus-plus.org/">Notepad++</a>. Other people like <a class="reference external" href="https://code.visualstudio.com/">VSCode</a>, although I do not use it so I cannot help you much with that.</p></li>
</ul>
</section>
<section id="getting-the-lecture-materials">
<h2>Getting the lecture materials<a class="headerlink" href="#getting-the-lecture-materials" title="Link to this heading">¶</a></h2>
<p>This section contains some commands that will get you the source code and setup qudi on you computer. Everything is installed in a Python virtual environment so the impact on your system should be minimal (you can simply delete the folder once the lecture is over if you want to get rid of it).</p>
<p>Everything we need, including the interactive version of this notebook, is hosted in our <a class="reference external" href="https://github.com/Lab-on-a-Molecule-Quantum-Nanophotonics/qudi-lab-on-a-molecule-modules">public repository</a>. The first task is to recover it using <code class="docutils literal notranslate"><span class="pre">git</span></code>. There are several ways of using the tool (VSCode users can do it from the editor I think), I will present the simplest: using it directly from the command line. For Mac and Linux users, your operating system already provide a decently functionnal command line interface, please open one. For Windows users, if you installed <code class="docutils literal notranslate"><span class="pre">git</span></code> following the instructions above, you also installed a tool called <code class="docutils literal notranslate"><span class="pre">Git</span> <span class="pre">Bash</span></code> that emulates the command line interface, you can launch it from the startup menu.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Windows provides natively a terminal emulator, but the commands are different from the commands provided by MacOS and Linux (and provides honnestly a pretty bad experience). To simplify this lecture I will make you use <code class="docutils literal notranslate"><span class="pre">Git</span> <span class="pre">Bash</span></code>, as it is modeled on a more standard command line interface.</p>
</div>
<p>You should now see a text window (likely with a black or white background). The text displayed depends on your specific configuration. For example, mine is very minimalistic.</p>
<figure class="align-default" id="id8">
<a class="reference internal image-reference" href="_images/af91774f-40f8-439f-a5eb-cde6a11e007e.png"><img alt="Screenshot of an empty terminal" src="_images/af91774f-40f8-439f-a5eb-cde6a11e007e.png" style="width: 60%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 1 </span><span class="caption-text">Example of an empty terminal.</span><a class="headerlink" href="#id8" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>This is a way to interact with you computer using (mostly) text. It can seem a bit scary, but is actually very efficient. Instead of using your mouse, you will be typing <strong>commands</strong> that I will give you. If you need to copy and paste, the shortcuts might be a bit different than the ones you might be used to.</p>
<ul class="simple">
<li><p>On MacOS, you can copy and paste using <kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">Command</kbd>+<kbd class="kbd docutils literal notranslate">C</kbd></kbd> and <kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">Command</kbd>+<kbd class="kbd docutils literal notranslate">V</kbd></kbd>, see <a class="reference external" href="https://support.apple.com/en-gb/guide/terminal/trmlshtcts/mac">this list of keyboard shortcuts on Mac</a>,</p></li>
<li><p>On Linux, you can copy and paste using <kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">Control</kbd>+<kbd class="kbd docutils literal notranslate">Shift</kbd>+<kbd class="kbd docutils literal notranslate">C</kbd></kbd> and <kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">Control</kbd>+<kbd class="kbd docutils literal notranslate">Shift</kbd>+<kbd class="kbd docutils literal notranslate">V</kbd></kbd>,</p></li>
<li><p>On Windows, using git bash, you can copy text by pressing <kbd class="kbd docutils literal notranslate">Shift</kbd> then selecting the text you want to copy using the mouse and then press <kbd class="kbd docutils literal notranslate">Enter</kbd>. You can paste text using <kbd class="kbd docutils literal notranslate">Insert</kbd>.</p></li>
</ul>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Be mindful of what you are doing in a terminal. For example, pressing <kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">Control</kbd>+<kbd class="kbd docutils literal notranslate">C</kbd></kbd> will interrupt the currently running command! In doubt, ask for help.</p>
</div>
<p>The first step is to decide in which directory to put the materials for this lecture. To know where you currently are, you can run the <code class="docutils literal notranslate"><span class="pre">pwd</span></code> command: it returns the current directory. You can do so by typing <code class="docutils literal notranslate"><span class="pre">pwd</span></code>, then pressing <code class="docutils literal notranslate"><span class="pre">Enter</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">pwd</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">klafyvel</span>
</pre></div>
</div>
<p>I am currently in the directory <code class="docutils literal notranslate"><span class="pre">/home/klafyvel</span></code>. If you want to work in another directory, you can change directory using the <code class="docutils literal notranslate"><span class="pre">cd</span></code> command. For example, I will work in <code class="docutils literal notranslate"><span class="pre">/home/klafyvel/Documents</span></code>, so I can go there as follows:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>Documents<span class="w"> </span>
<span class="nb">pwd</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">klafyvel</span><span class="o">/</span><span class="n">Documents</span>
</pre></div>
</div>
<p>I can list the files in the current directory using the <code class="docutils literal notranslate"><span class="pre">ls</span></code> command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ls
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>My personal folders!
</pre></div>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Before launching commands that depend on the current directory, always check that you are in the correct directory! These commands <code class="docutils literal notranslate"><span class="pre">pwd</span></code>, <code class="docutils literal notranslate"><span class="pre">cd</span></code>, and <code class="docutils literal notranslate"><span class="pre">ls</span></code> are your best friends!</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you are interested in learning more how to use the command line you might read a tutorial on <code class="docutils literal notranslate"><span class="pre">bash</span></code> command line, although this is not required to follow this lecture.</p>
</div>
<p>At this point, you should have a terminal open, and be in the directory where you want to work from. You can now download the material by invoking the <code class="docutils literal notranslate"><span class="pre">git</span></code> command as follow:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/Lab-on-a-Molecule-Quantum-Nanophotonics/qudi-lab-on-a-molecule-modules
</pre></div>
</div>
<p>It will display some information on what <code class="docutils literal notranslate"><span class="pre">git</span></code> is currently doing, for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Cloning</span> <span class="n">into</span> <span class="s1">&#39;qudi-lab-on-a-molecule-modules&#39;</span><span class="o">...</span>
<span class="n">remote</span><span class="p">:</span> <span class="n">Enumerating</span> <span class="n">objects</span><span class="p">:</span> <span class="mi">54378</span><span class="p">,</span> <span class="n">done</span><span class="o">.</span>
<span class="n">remote</span><span class="p">:</span> <span class="n">Counting</span> <span class="n">objects</span><span class="p">:</span> <span class="mi">100</span><span class="o">%</span> <span class="p">(</span><span class="mi">52</span><span class="o">/</span><span class="mi">52</span><span class="p">),</span> <span class="n">done</span><span class="o">.</span>
<span class="n">remote</span><span class="p">:</span> <span class="n">Compressing</span> <span class="n">objects</span><span class="p">:</span> <span class="mi">100</span><span class="o">%</span> <span class="p">(</span><span class="mi">12</span><span class="o">/</span><span class="mi">12</span><span class="p">),</span> <span class="n">done</span><span class="o">.</span>
</pre></div>
</div>
<p>Once this is done, you can navigate to the directory using the <code class="docutils literal notranslate"><span class="pre">cd</span></code> command and have a first look at what has been downloaded using the <code class="docutils literal notranslate"><span class="pre">ls</span></code> command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>qudi-lab-on-a-molecule-modules
ls
</pre></div>
</div>
<p>This will display a list of files and directories</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">AUTHORS</span><span class="o">.</span><span class="n">md</span>  <span class="n">docs</span>  <span class="n">LICENSE</span>  <span class="n">LICENSE</span><span class="o">.</span><span class="n">LESSER</span>  <span class="n">pyproject</span><span class="o">.</span><span class="n">toml</span>  <span class="n">README</span><span class="o">.</span><span class="n">md</span>  <span class="n">src</span>  <span class="n">tests</span>  <span class="n">VERSION</span>
</pre></div>
</div>
<p>You can check that it corresponds to the files listed on <a class="reference external" href="https://github.com/Lab-on-a-Molecule-Quantum-Nanophotonics/qudi-lab-on-a-molecule-modules">the GitHub</a> page.</p>
<p>At this point we have downloaded the source code of our modules (if you don’t know what that is don’t worry, we will cover that later), but we still need to install Qudi and all the related dependencies. If you have used Python in the past, you might have encountered many difficulties with managing and installing packages. Because we use the <code class="docutils literal notranslate"><span class="pre">uv</span></code> package manager, that you should have installed following the previous section, all this is made much easier. It will take care of installing everything we need, including the correct Python version, the first time we invoke it. If you want to get scared, you can read the <a class="reference external" href="https://ulm-iqo.github.io/qudi-core/setup/installation.html">installation section</a> of the Qudi manual to see all the complicated steps that <code class="docutils literal notranslate"><span class="pre">uv</span></code> removes.</p>
<p>Before we actually run Qudi for the first time, we need one final step that will enable the interaction between jupyter notebooks and Qudi. The following command will do so:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>uv<span class="w"> </span>run<span class="w"> </span>qudi-install-kernel
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>We all love Microsoft (no).
<strong>Windows users</strong>: some libraries are complicated to install on Windows. If you are getting errors, you may get luckier using the <code class="docutils literal notranslate"><span class="pre">--no-dev</span></code> option to prevent <code class="docutils literal notranslate"><span class="pre">uv</span></code> from installing some developpment dependencies: <code class="docutils literal notranslate"><span class="pre">uv</span> <span class="pre">run</span> <span class="pre">--no-dev</span> <span class="pre">qudi-install-kernel</span></code>. If this fixes the issue, then you need to keep this <code class="docutils literal notranslate"><span class="pre">--no-dev</span></code> option for all <code class="docutils literal notranslate"><span class="pre">uv</span></code> calls used later.</p>
</div>
<p>Since it is the first time we invoke the <code class="docutils literal notranslate"><span class="pre">uv</span></code> command, it will install all the dependencies we need. <strong>This might take some time</strong>, so it is the good time to take a break and enjoy a coffee.</p>
<figure class="align-default" id="id9">
<a class="reference internal image-reference" href="_images/7210315e-1ae4-424a-9a7e-a24a33aa114a.png"><img alt="Screenshot of a terminal with the uv utility running." src="_images/7210315e-1ae4-424a-9a7e-a24a33aa114a.png" style="width: 60%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 2 </span><span class="caption-text">Example of the output of the previous command while <code class="docutils literal notranslate"><span class="pre">uv</span></code> is installing dependencies.</span><a class="headerlink" href="#id9" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</section>
<section id="running-qudi-and-the-interactive-notes">
<span id="id2"></span><h2>Running Qudi and the interactive notes<a class="headerlink" href="#running-qudi-and-the-interactive-notes" title="Link to this heading">¶</a></h2>
<section id="running-qudi">
<h3>Running Qudi<a class="headerlink" href="#running-qudi" title="Link to this heading">¶</a></h3>
<p>At this stage, Qudi has been installed in our local directory and can be launched. From a terminal in the tutorial directory (refer to the previous sections if you are unsure of how to get one), you can now use the <code class="docutils literal notranslate"><span class="pre">qudi</span></code> command through <code class="docutils literal notranslate"><span class="pre">uv</span></code>. Qudi accepts a few parameters through the command line. We can get some help about them using the <code class="docutils literal notranslate"><span class="pre">--help</span></code> parameter:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>uv<span class="w"> </span>run<span class="w"> </span>qudi<span class="w"> </span>--help<span class="w">       </span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">usage</span><span class="p">:</span> <span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">qudi</span><span class="o">.</span><span class="n">core</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">g</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">d</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">c</span> <span class="n">CONFIG</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">l</span> <span class="n">LOGDIR</span><span class="p">]</span>

<span class="n">options</span><span class="p">:</span>
  <span class="o">-</span><span class="n">h</span><span class="p">,</span> <span class="o">--</span><span class="n">help</span>            <span class="n">show</span> <span class="n">this</span> <span class="n">help</span> <span class="n">message</span> <span class="ow">and</span> <span class="n">exit</span>
  <span class="o">-</span><span class="n">g</span><span class="p">,</span> <span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">gui</span>          <span class="n">Run</span> <span class="n">qudi</span> <span class="s2">&quot;headless&quot;</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span> <span class="n">without</span> <span class="n">GUI</span><span class="o">.</span> <span class="n">User</span> <span class="n">interaction</span> <span class="n">only</span> <span class="n">possible</span> <span class="n">via</span> <span class="n">IPython</span> <span class="n">kernel</span><span class="o">.</span>
  <span class="o">-</span><span class="n">d</span><span class="p">,</span> <span class="o">--</span><span class="n">debug</span>           <span class="n">Run</span> <span class="n">qudi</span> <span class="ow">in</span> <span class="n">debug</span> <span class="n">mode</span> <span class="n">to</span> <span class="n">log</span> <span class="nb">all</span> <span class="n">debug</span> <span class="n">messages</span><span class="o">.</span> <span class="n">Can</span> <span class="n">affect</span> <span class="n">performance</span><span class="o">.</span>
  <span class="o">-</span><span class="n">c</span> <span class="n">CONFIG</span><span class="p">,</span> <span class="o">--</span><span class="n">config</span> <span class="n">CONFIG</span>
                        <span class="n">Path</span> <span class="n">to</span> <span class="n">the</span> <span class="n">configuration</span> <span class="n">file</span> <span class="n">to</span> <span class="n">use</span> <span class="k">for</span> <span class="k">for</span> <span class="n">this</span> <span class="n">qudi</span> <span class="n">session</span><span class="o">.</span>
  <span class="o">-</span><span class="n">l</span> <span class="n">LOGDIR</span><span class="p">,</span> <span class="o">--</span><span class="n">logdir</span> <span class="n">LOGDIR</span>
                        <span class="n">Absolute</span> <span class="n">path</span> <span class="n">to</span> <span class="n">log</span> <span class="n">directory</span> <span class="n">to</span> <span class="n">use</span> <span class="n">instead</span> <span class="n">of</span> <span class="n">the</span> <span class="n">default</span> <span class="n">one</span> <span class="s2">&quot;&lt;user_home&gt;/qudi/log/&quot;</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">--config</span></code> option is of peculiar interest to us. As we will see later, with Qudi we use a configuration file to describe the setup and how the various components are configured and connect to one another. This file uses <a class="reference external" href="https://learnxinyminutes.com/yaml/">the YAML (YAML Ain’t Markup Language) syntax</a>, and we will play with it later. For now, you are provided with two configuration files:</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">default.cfg</span></code> file, located in <code class="docutils literal notranslate"><span class="pre">src/qudi/default.cfg</span></code>. This file is kindly provided by the developpers of the Ulm-IQO module, and showcases many possibilities of qudi using dummy hardwares.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">crash_course.cfg</span></code> file, located in <code class="docutils literal notranslate"><span class="pre">src/qudi/crash_course.cfg</span></code>. We will use and edit this file to understand together how Qudi works.</p></li>
</ul>
<p>By default, if you do not specify a configuration file, Qudi uses the last configuration file used. If you are reading ahead before the lecture, I encourage you to try the default configuration and try to play with all the user interfaces. On the day of the lecture, I want you to use the <code class="docutils literal notranslate"><span class="pre">crash_course.cfg</span></code> file. The configuration file can also be changed from the user interface.</p>
<section id="selecting-the-configuration-file-from-the-command-line">
<h4>Selecting the configuration file from the command line<a class="headerlink" href="#selecting-the-configuration-file-from-the-command-line" title="Link to this heading">¶</a></h4>
<p>To run a specific configuration file from the command line, you need to specify the <a class="reference external" href="https://en.wikipedia.org/wiki/Path_(computing)">absolute path</a> to the file. For example for the default file <em>on my computer</em>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>uv<span class="w"> </span>run<span class="w"> </span>qudi<span class="w"> </span>--config<span class="w"> </span>/home/klafyvel/Documents/qudi-lab-on-a-molecule-modules/src/qudi/default.cfg
</pre></div>
</div>
</section>
<section id="selecting-the-configuration-file-from-the-user-interface">
<h4>Selecting the configuration file from the user interface<a class="headerlink" href="#selecting-the-configuration-file-from-the-user-interface" title="Link to this heading">¶</a></h4>
<p>This is perhaps the simplest way if you are not comfortable with the command line. From the terminal, you can run Qudi without any options:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>uv<span class="w"> </span>run<span class="w"> </span>qudi
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>On the computers of the setups, we have a shortcut that runs Qudi for us. There is no underlying magic: it simply opens a terminal at the right location and runs the above command!</p>
</div>
<p>The goal of this section is not to explore the main Qudi interface. However, it is useful to see that it displays the name of the currently loaded configuration file at the very bottom:</p>
<figure class="align-default" id="id10">
<a class="reference internal image-reference" href="_images/b5e71907-597a-40ba-b774-bff484374926.png"><img alt="Screenshot of the bottom of the main Qudi window." src="_images/b5e71907-597a-40ba-b774-bff484374926.png" style="width: 100%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 3 </span><span class="caption-text">The very bottom of the main Qudi window, displaying the version number and the path of the configuration file loaded.</span><a class="headerlink" href="#id10" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>You can choose another file from the menu by clicking on <code class="docutils literal notranslate"><span class="pre">File</span> <span class="pre">&gt;</span> <span class="pre">Load</span> <span class="pre">configuration</span></code></p>
<figure class="align-default" id="id11">
<a class="reference internal image-reference" href="_images/ac4463e1-e59c-4f0d-8f61-de54d68881c1.png"><img alt="Screenshot of the file explorer showing a configuration file." src="_images/ac4463e1-e59c-4f0d-8f61-de54d68881c1.png" style="width: 60%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 4 </span><span class="caption-text">The file explorer window to select the configuration file may vary depending on your specific configuration</span><a class="headerlink" href="#id11" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>After selecting the file, Qudi will ask you to restart the program to load the new configuration. Click on “Yes”.</p>
<figure class="align-default" id="id12">
<a class="reference internal image-reference" href="_images/3d77eeac-ba7a-4845-beca-01fc92821911.png"><img alt="Screenshot of the dialog window asking if you want to restart Qudi." src="_images/3d77eeac-ba7a-4845-beca-01fc92821911.png" style="width: 60%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 5 </span><span class="caption-text">Yes, we want to restart Qudi!</span><a class="headerlink" href="#id12" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</section>
</section>
<section id="running-the-jupyter-notebook">
<h3>Running the Jupyter notebook<a class="headerlink" href="#running-the-jupyter-notebook" title="Link to this heading">¶</a></h3>
<p>While installing Qudi, we also intalled a jupyter notebook. You need a terminal available to run commands in the tutorial directory. If you previously closed your terminal, open it again and navigate to the directory using the <code class="docutils literal notranslate"><span class="pre">cd</span></code> command as before.</p>
<p>Once you are there, you can start the jupyter notebook through <code class="docutils literal notranslate"><span class="pre">uv</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>uv<span class="w"> </span>run<span class="w"> </span>jupyter<span class="w"> </span>notebook
</pre></div>
</div>
<p>This will open a web browser and display a page listing the current directory:</p>
<figure class="align-default" id="id13">
<a class="reference internal image-reference" href="_images/7c9411a8-83e4-434c-918e-f747d55cfea4.png"><img alt="Screenshot of the jupyter file explorer." src="_images/7c9411a8-83e4-434c-918e-f747d55cfea4.png" style="width: 60%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 6 </span><span class="caption-text">The jupyter file explorer.</span><a class="headerlink" href="#id13" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>Navigate to the folder <code class="docutils literal notranslate"><span class="pre">docs/source</span></code>, where the interactive version of this notebook lives:</p>
<figure class="align-default" id="id14">
<a class="reference internal image-reference" href="_images/0add01ec-7e1f-4953-89df-677302243964.png"><img alt="Screenshot of the jupyter file explorer." src="_images/0add01ec-7e1f-4953-89df-677302243964.png" style="width: 60%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 7 </span><span class="caption-text">The jupyter file explorer showing the directory where this tutorial lives.</span><a class="headerlink" href="#id14" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>And then double-click on the file “Crash course into Qudi.ipynb”.</p>
<p>For comfort, you might want to enable the Table of Contents pannel. You can do this by clicking on <code class="docutils literal notranslate"><span class="pre">View</span> <span class="pre">&gt;</span> <span class="pre">Table</span> <span class="pre">of</span> <span class="pre">Contents</span></code>.</p>
<figure class="align-default" id="id15">
<a class="reference internal image-reference" href="_images/6792b125-e465-4d14-9e9f-9619bd40279b.png"><img alt="Screenshot of the jupyter toolbar to enable the table of contents." src="_images/6792b125-e465-4d14-9e9f-9619bd40279b.png" style="width: 30%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 8 </span><span class="caption-text">The jupyter toolbar to enable the table of contents.</span><a class="headerlink" href="#id15" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>In the Qudi main window, you should see a log line in the Qudi main window that tells you that the jupyter kernel connected to Qudi.</p>
<figure class="align-default" id="id16">
<a class="reference internal image-reference" href="_images/3aab4ccd-d298-4c26-a158-884ae95b8a4d.png"><img alt="Screenshot of the Qudi main window log viewer." src="_images/3aab4ccd-d298-4c26-a158-884ae95b8a4d.png" style="width: 100%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 9 </span><span class="caption-text">The jupyter kernel connected to my Qudi application.</span><a class="headerlink" href="#id16" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p><strong>You are ready!</strong></p>
</section>
</section>
<section id="what-you-can-read-in-addition">
<h2>What you can read in addition<a class="headerlink" href="#what-you-can-read-in-addition" title="Link to this heading">¶</a></h2>
<p>Although we will be covering most of it, you can read the <a class="reference external" href="https://ulm-iqo.github.io/qudi-core/#design-concepts">design concepts section</a> of the Qudi manual.</p>
</section>
</section>
<section id="at-the-beginning-of-the-lecture">
<span id="id3"></span><h1>At the beginning of the lecture<a class="headerlink" href="#at-the-beginning-of-the-lecture" title="Link to this heading">¶</a></h1>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Please start Qudi and this notebook!</p>
</div>
</section>
<section id="a-crash-course-into-qudi">
<span id="id4"></span><h1>A crash course into Qudi<a class="headerlink" href="#a-crash-course-into-qudi" title="Link to this heading">¶</a></h1>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is a work in progress.</p>
</div>
<center>
    Lecture notes by <b>Hugo Levy-Falk</b>, CNR-INO
</center>
<figure class="align-center" id="id17">
<a class="reference internal image-reference" href="_images/lazy_me.jpeg"><img alt="A comics showing expectations vs reality when automating setups. One expects to relax while the setup is running automatically, while in reality one can only dream of that while fixing code." src="_images/lazy_me.jpeg" style="width: 60%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 10 </span><span class="caption-text">The reality of automating experiments.</span><a class="headerlink" href="#id17" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<br/>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>At this point, it helps a lot if you have already read and followed the <a class="reference internal" href="#before-the-lecture">Before the lecture</a> and <a class="reference internal" href="#at-the-beginning-of-the-lecture">At the beginning of the lecture</a> sections and installed the requirements to follow the interactive bits. However, if you joined-in late, you can still get the lecture notes and follow along.</p>
</div>
<figure class="align-default" id="id18">
<a class="reference internal image-reference" href="_images/logo.svg"><img alt="_images/logo.svg" src="_images/logo.svg" style="width: 60%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 11 </span><span class="caption-text">Get the lecture notes at <a class="reference external" href="https://lab-on-a-molecule-quantum-nanophotonics.github.io/qudi-lab-on-a-molecule-modules/Crash%20course%20into%20Qudi.html">https://lab-on-a-molecule-quantum-nanophotonics.github.io/qudi-lab-on-a-molecule-modules/</a></span><a class="headerlink" href="#id18" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>Today, I want to discuss:</p>
<ul class="simple">
<li><p>Why we automate data aquisition and pre-analysis, why we use a framework / a library rather than a simple <em>ad-hoc</em> script, what tools are available, and why we choose Qudi;</p></li>
<li><p>The structure and basics of Qudi, with a practical example (this is an interactive lecture!)</p></li>
<li><p>How to deal with errors</p></li>
<li><p>A broad overview of the modules useful for single-molecule experiments</p></li>
<li><p>A specific focus on the laser scanning module that we use for single-molecule experiments and laser control</p></li>
</ul>
<p>There are two levels for following this lecture:</p>
<ol class="arabic simple">
<li><p>Having a broad overview of how Qudi is built, being able to run a pre-written configuration, and deal with some errors,</p></li>
<li><p>Being able to interact with Qudi using Python code, write some configuration, deal with more advanced errors.</p></li>
</ol>
<p>The notes are available online, so you can also come back on the examples later-on if needed.</p>
</section>
<section id="hello-qudi">
<h1>Hello, Qudi!<a class="headerlink" href="#hello-qudi" title="Link to this heading">¶</a></h1>
<p>In this section I would like to introduce the rationale behind automating experiments and the method used to achieve that.</p>
<section id="why-automation">
<h2>Why automation?<a class="headerlink" href="#why-automation" title="Link to this heading">¶</a></h2>
<p>We operate complex instruments, and need to perform repetitive measurements systematically. These are two tasks that a computer is very good at solving.</p>
<p>We want a software that:</p>
<ul class="simple">
<li><p>Is able to handle the variability in instrumentation,</p></li>
<li><p>Facilitates the systematic handling of experiments,</p></li>
<li><p>Provides traceability of data provenance and experimental settings,</p></li>
<li><p>Is easy enough to tweak, expand, and re-use.</p></li>
</ul>
</section>
<section id="why-a-framework">
<h2>Why a framework?<a class="headerlink" href="#why-a-framework" title="Link to this heading">¶</a></h2>
<p>We are all able, given enough time, to write a script that <em>kind of work</em>™ to make a specific measurement. The problems with this approach are:</p>
<ul class="simple">
<li><p>This is time consuming,</p></li>
<li><p>You will likely reinvent the wheel everytime,</p></li>
<li><p>You will likely end-up with a single huge, poorly documented, fragile spaghetti-code script that nobody understands after two rotations of non-permanent people in the lab.</p></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Spaghetti code</p>
<blockquote>
<div><p>Spaghetti code is computer source code that encodes control flow that is convoluted, and therefore, hard to understand. Control statements direct program execution in ways that instead of having a quality of structure, resembles cooked spaghetti, twisted and tangled. The code tends to be hard to maintain.</p>
<p>– <a class="reference external" href="https://en.wikipedia.org/wiki/Spaghetti_code">Wikipedia page on spaghetti code</a></p>
</div></blockquote>
</div>
<p><strong>Designing (good) software is a job</strong>. Software engineering is challenging and is a skill that takes time and experience to acquire. What do we mean by “good” software?</p>
<ul class="simple">
<li><p>The software performs its task correctly,</p></li>
<li><p>The software performs its task efficiently,</p></li>
<li><p>The software is documented so users can learn how to use it and understand what it does,</p></li>
<li><p>The code is documented so new people can work on it,</p></li>
<li><p>The code is sufficiently well structured that it will facilitate maintenance and addition of new functionalities.</p></li>
</ul>
<p><strong>We are not software engineers.</strong> This is why we want to avoid making software engineering decisions as much as possible. One solution is to use a <strong>framework</strong>. This is a fancy name to describe a big library that, among other things, encourages or even enforces some code practices. The goal is to produce good software thanks to these guiding rules and the available code base in the framework.</p>
</section>
<section id="so-many-available-frameworks">
<h2>So many available frameworks<a class="headerlink" href="#so-many-available-frameworks" title="Link to this heading">¶</a></h2>
<p>Many people have had a hand at automating experiments. Some people tried to compile <a class="reference external" href="https://pymeasure.github.io/python-lab-automation-landscape/catalog/">lists of available frameworks</a>. Among them are:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/PyMoDAQ/PyMoDAQ">PyMoDAQ</a>, developped at CNRS in France,</p></li>
<li><p><a class="reference external" href="https://microsoft.github.io/Qcodes/index.html">QCoDeS</a>, developped by the Copenhagen / Delft / Sydney / Microsoft quantum computing consortium,</p></li>
<li><p><a class="reference external" href="https://github.com/pymeasure/pymeasure">PyMeasure</a>, by Colin Jermain and Graham Rowlands at Cornell University,</p></li>
<li><p><a class="reference external" href="https://github.com/Ulm-IQO/qudi-core">Qudi</a>, developped at the Institute for Quantum Optics, Ulm in Germany</p></li>
</ul>
<p>With so many choices available, how do we pick one?</p>
<ul class="simple">
<li><p>Look into what is used in your field</p></li>
<li><p>Check how different frameworks have different approaches</p></li>
<li><p>Check from previous experience in your team</p></li>
<li><p>See to what extend you can collaborate with your colleagues in other teams of your institute</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is still useful to know that other frameworks exists. Scientific instruments manufacturers are famously terrible at documenting how to tweak, script and sometimes simply use their hardwares. If someone else using another framework has been able to make a hardware that you need work, you may take inspiration from them!</p>
</div>
</section>
<section id="qudi">
<h2>Qudi<a class="headerlink" href="#qudi" title="Link to this heading">¶</a></h2>
<p>Qudi is an automation framework developped at Ulm IQO by people working on NV centers in diamond, but its scope is way more general. It devides the code in re-usable modules by abstracting the hardware layer. In addition it provides many experimental commodities for saving data and metadata, connecting modules on different computers, configuring experiments, saving status…</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Please, reference the <a class="reference external" href="https://doi.org/10.1016/j.softx.2017.02.001">Binder <em>et al</em>, <strong>Software</strong>, 6 (2017), pp. 85-90, 10.1016/j.softx.2017.02.001</a> paper in your methods when you use Qudi for your experiments! This helps them getting funds to work on improving Qudi!</p>
</div>
<p>Qudi by itself is only a framework. This means a collection of utilities to write programs in a certain ways. This is called <a class="reference external" href="https://github.com/Ulm-IQO/qudi-core">Qudi core</a>. On top of the core, people write their own Python modules to provide supports for instruments, acquisition logics, and user interfaces. The team at <a class="reference external" href="https://github.com/Ulm-IQO/qudi-iqo-modules/">Ulm IQO open-sourced their modules</a>, and we use their repository as a base for <a class="reference external" href="https://github.com/Lab-on-a-Molecule-Quantum-Nanophotonics/qudi-lab-on-a-molecule-modules">our own modules</a>.
If you don’t need any of the instruments, logics, or user interfaces provided, you can make your own Python module from scratch without using the Ulm IQO repository as a basis, and only relying on the lightweight Qudi core.</p>
</section>
</section>
<section id="basics-of-qudi">
<h1>Basics of Qudi<a class="headerlink" href="#basics-of-qudi" title="Link to this heading">¶</a></h1>
<section id="the-hardware-logic-gui-stack">
<h2>The Hardware, Logic, GUI stack<a class="headerlink" href="#the-hardware-logic-gui-stack" title="Link to this heading">¶</a></h2>
<p>The main logical structure of Qudi is shown below. Qudi is built around the idea of <strong>logic</strong> modules. Logics control hardwares and are controlled either through Graphical User Interfaces (GUI) or Jupyter notebooks.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you want a more technical explanation, you will find <a class="reference external" href="https://ulm-iqo.github.io/qudi-core/design_concepts/measurement_modules.html">the official Qudi documentation</a> useful.</p>
</div>
<figure class="align-default" id="id19">
<a class="reference internal image-reference" href="_images/diagram.jpeg"><img alt="A diagram showing the module structure of Qudi." src="_images/diagram.jpeg" style="width: 50%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 12 </span><span class="caption-text">The basics of the basics: Hardware, interfaces, logics, and Graphical User Interfaces (GUI)</span><a class="headerlink" href="#id19" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<section id="logic-modules">
<h3>Logic modules<a class="headerlink" href="#logic-modules" title="Link to this heading">¶</a></h3>
<p>A logic should be understood as the brain of an experiment. Concretely, this will describe how to interface a set of hardwares or other logics to produce an experimental result. For example, the laser scanning logic configures a scanning laser to scan a range of frequencies and acquire a set of data. Logics are also responsible for data analysis, storage, and monitoring of the experiment. They can rely heavily on helper functions of Qudi.</p>
</section>
<section id="hardwares">
<h3>Hardwares<a class="headerlink" href="#hardwares" title="Link to this heading">¶</a></h3>
<p>A hardware is a Python class that is tasked with interfacing with the actual hardware. To be able to be used by a specific logic, the hardware must implement the correct <a class="reference internal" href="#interfaces"><span class="std std-ref">Interfaces</span></a>. Concretely, the role of the hardware module is to abstract the specifics of an instrument or a piece of hardware, and make it behave like all the other hardwares of the same kind present in Qudi. For example, Thorlabs provides <a class="reference external" href="https://www.thorlabs.com/Software/Motion%20Control/APT_Communications_Protocol.pdf">the documentation for the communication protocol used for their motorized flip mounts</a>, as well as some <a class="reference external" href="https://github.com/Thorlabs/Motion_Control_Examples">code examples of how to use their flip mounts</a>. This is great (and sets them appart from many manufacturers!), but the code provided is not directly compatible with Qudi. To use them in Qudi, we want to write a hardware module that implements an <strong><a class="reference internal" href="#interfaces">interface</a></strong> that is understood by the logics of Qudi. In this case, the switch interface is well suited (after all, this is a hardware that has two states, just like a switch), and so we wrote <a class="reference external" href="https://github.com/Lab-on-a-Molecule-Quantum-Nanophotonics/qudi-lab-on-a-molecule-modules/blob/main/src/qudi/hardware/switches/thorlabs_flip_mount.py">some glue code that bridges the examples given by Thorlabs to Qudi by implementing the correct interface</a>.</p>
</section>
<section id="interfaces">
<span id="id5"></span><h3>Interfaces<a class="headerlink" href="#interfaces" title="Link to this heading">¶</a></h3>
<p>We want to keep the logics as generalistic as possible. Going back to the example of the laser scanning logic, we want to be able to use it with all our lasers without rewriting it. This issue of being able to interface the same logic with a variety of hardwares that fill the same function is solved through <strong>interfaces</strong>. An interface can be understood as a promise that a hardware module will behave in a certain way and provide a set of methods. For example, the laser hardwares must implement the  <a class="reference external" href="https://github.com/Lab-on-a-Molecule-Quantum-Nanophotonics/qudi-lab-on-a-molecule-modules/blob/main/src/qudi/interface/excitation_scanner_interface.py"><code class="docutils literal notranslate"><span class="pre">ExcitationScannerInterface</span></code></a> to be compatible with the laser scanning logic. <strong>This is very powerful</strong>, because it means that often you can integrate a new hardware with the existing logics by simply reading its documentation and writing the adequate hardware module using the interface definition as a template.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You can also have a look at the <a class="reference external" href="https://ulm-iqo.github.io/qudi-core/design_concepts/hardware_interface.html">Hardware Interfaces</a> page of Qudi’s documentation.</p>
</div>
</section>
<section id="graphical-user-interfaces-gui">
<h3>Graphical User Interfaces (GUI)<a class="headerlink" href="#graphical-user-interfaces-gui" title="Link to this heading">¶</a></h3>
<p>Even though logic modules can be controlled via explicit Python code (for example in Jupyter notebooks), it is also convenient for daily operations to have a nice user interface. This is the role of GUIs. GUIs should only handle presentation of data, and control of logic modules. Logic modules are unaware of the GUI modules. This separation of concern also makes the code simpler, since logic don’t have to bother with user interactions.</p>
</section>
<section id="where-all-these-live">
<h3>Where all these live<a class="headerlink" href="#where-all-these-live" title="Link to this heading">¶</a></h3>
<p>The repository where our Qudi modules live looks like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>.
├── AUTHORS.md
├── Crash course into Qudi.html
├── docs
│   ... All the documentation files
├── LICENSE
├── LICENSE.LESSER
├── pyproject.toml
├── README.md
├── src
│   └── qudi
│       ├── default.cfg
│       ├── gui &lt;- All the GUI modules live there
│       ├── hardware &lt;- All the hardware modules live there
│       ├── interface &lt;- All the interfaces are defined there
│       ├── logic &lt;- All the logics live there
│       ├── scripts &lt;- These are some scripts, I will not cover it today, I think it is better that we use jupyter notebooks instead
│       └── util &lt;- We extend Qudi here, in particular with the TOMLDataStorage that we will cover at the end.
├── tests
│   ... All unit tests
├── uv.lock
└── VERSION
</pre></div>
</div>
</section>
</section>
<section id="writing-our-first-configuration-file">
<h2>Writing our first configuration file<a class="headerlink" href="#writing-our-first-configuration-file" title="Link to this heading">¶</a></h2>
<p>In this section, we will write (and hopefully understand) a Qudi configuration file. A configuration file can be understood as a recipe that explains to Qudi which modules (GUIs, logics, and hardwares) should be instancied, how they should connect to one another, and how they sould be configured. In addition, it provides some general configuration for Qudi. The configuration is stored in a text file, formated in YAML (Yet Another Markup Language, if you haven’t done so yet, you can check out <a class="reference external" href="https://learnxinyminutes.com/yaml/">this guide</a>). You can edit it with any text editor.</p>
<figure class="align-default" id="id20">
<a class="reference internal image-reference" href="_images/writing_configuration.jpeg"><img alt="A character is trying to connect a logic and a hardware modules." src="_images/writing_configuration.jpeg" style="width: 40%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 13 </span><span class="caption-text">Writing configuration is as easy as finding which pieces fit. Writing working configuration is a bit harder.</span><a class="headerlink" href="#id20" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<section id="configuration-file-layout">
<h3>Configuration file layout<a class="headerlink" href="#configuration-file-layout" title="Link to this heading">¶</a></h3>
<p>Qudi configuration files typically consist in four sections: <code class="docutils literal notranslate"><span class="pre">global</span></code>, <code class="docutils literal notranslate"><span class="pre">gui</span></code>, <code class="docutils literal notranslate"><span class="pre">logic</span></code>, and <code class="docutils literal notranslate"><span class="pre">hardware</span></code>.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">global</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># global parameters for Qudi</span>
<span class="nt">gui</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># Configuration of GUI modules</span>
<span class="nt">logic</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># Configuration of Logic modules</span>
<span class="nt">hardware</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># Configuration of Hardware modules</span>
</pre></div>
</div>
</section>
<section id="global-section">
<h3>Global section<a class="headerlink" href="#global-section" title="Link to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">global</span></code> section has the following fields availale:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">global</span><span class="p">:</span>
<span class="w">    </span><span class="nt">startup_modules</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span>
<span class="w">    </span><span class="nt">remote_modules_server</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">    </span><span class="nt">namespace_server_port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">18861</span>
<span class="w">    </span><span class="nt">force_remote_calls_by_value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">True</span>
<span class="w">    </span><span class="nt">hide_manager_window</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span>
<span class="w">    </span><span class="nt">stylesheet</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;qdark.qss&#39;</span>
<span class="w">    </span><span class="nt">default_data_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">    </span><span class="nt">daily_data_dirs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">True</span>
<span class="w">    </span><span class="nt">extension_paths</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Going through all these fields is beyond the point of this introduction. Refer to <a class="reference external" href="https://ulm-iqo.github.io/qudi-core/design_concepts/configuration.html">Qudi’s documentation</a> to learn more. Here I list the most important ones.</p>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">startup_modules</span></code>: This lists the modules we want to start automatically when we run Qudi. This avoids having to launch the manually.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">remote_modules_server</span></code>: This is how we make Qudi aware of another instance running on another network. Refer to the documentation for how to use it.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">default_data_dir</span></code>: This is where Qudi will store the data when saving. We systematically overwrite this in our configurations to make it point to the shared drives!</p></li>
</ul>
</section>
<section id="modules-sections">
<span id="module-section"></span><h3>Modules sections<a class="headerlink" href="#modules-sections" title="Link to this heading">¶</a></h3>
<p>Here, I will only cover the configuration of local modules, refer to the <a class="reference external" href="https://ulm-iqo.github.io/qudi-core/design_concepts/configuration.html">documentation page on configuration</a> to learn about configuring remote modules.</p>
<p>The GUI, logic, and hardware modules are configured in their respective sections: <code class="docutils literal notranslate"><span class="pre">gui</span></code>, <code class="docutils literal notranslate"><span class="pre">logic</span></code>, and <code class="docutils literal notranslate"><span class="pre">hardware</span></code>.</p>
<p>The configuration of a module itself contains three elements (for example, for a logic):</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">logic</span><span class="p">:</span>
<span class="w">    </span><span class="nt">my_logic</span><span class="p">:</span>
<span class="w">        </span><span class="nt">module.Class</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my_example_logic.MyExampleLogic</span>
<span class="w">        </span><span class="nt">options</span><span class="p">:</span>
<span class="w">            </span><span class="nt">my_config_option</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;I</span><span class="nv"> </span><span class="s">am</span><span class="nv"> </span><span class="s">a</span><span class="nv"> </span><span class="s">string</span><span class="nv"> </span><span class="s">from</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">qudi</span><span class="nv"> </span><span class="s">configuration&#39;</span>
<span class="w">        </span><span class="nt">connect</span><span class="p">:</span>
<span class="w">            </span><span class="nt">a_connector</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">a_defined_hardware_or_logic</span>
</pre></div>
</div>
<section id="module-class">
<h4>module.Class<a class="headerlink" href="#module-class" title="Link to this heading">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">module.Class</span></code> element tells Qudi which Python class to use for this module. Since we are in the <code class="docutils literal notranslate"><span class="pre">logic</span></code> section, Qudi will look directly in the folder of the logics. To find what to put here, we need to do a bit of investigation. For a logic, the directory contains the following files:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">camera_logic</span><span class="o">.</span><span class="n">py</span>          <span class="n">qdplot_logic</span><span class="o">.</span><span class="n">py</span>
<span class="n">interface_test_logic</span><span class="o">.</span><span class="n">py</span>  <span class="n">scanning_data_logic</span><span class="o">.</span><span class="n">py</span>
<span class="n">laser_logic</span><span class="o">.</span><span class="n">py</span>           <span class="n">scanning_excitation_spectroscopy</span><span class="o">.</span><span class="n">py</span>
<span class="n">laser_scanner_logic</span><span class="o">.</span><span class="n">py</span>   <span class="n">scanning_optimize_logic</span><span class="o">.</span><span class="n">py</span>
<span class="n">nv_calculator_logic</span><span class="o">.</span><span class="n">py</span>   <span class="n">scanning_probe_logic</span><span class="o">.</span><span class="n">py</span>
<span class="n">odmr_logic</span><span class="o">.</span><span class="n">py</span>            <span class="n">software_pid_controller</span><span class="o">.</span><span class="n">py</span>
<span class="n">pid_logic</span><span class="o">.</span><span class="n">py</span>             <span class="n">spectrometer_logic</span><span class="o">.</span><span class="n">py</span>
<span class="n">poi_manager_logic</span><span class="o">.</span><span class="n">py</span>     <span class="n">switch_logic</span><span class="o">.</span><span class="n">py</span>
<span class="n">power_sweep_logic</span><span class="o">.</span><span class="n">py</span>     <span class="n">temperature_global_save</span><span class="o">.</span><span class="n">py</span>
<span class="n">pulsed</span>                   <span class="n">time_series_reader_logic</span><span class="o">.</span><span class="n">py</span>
<span class="n">__pycache__</span>
</pre></div>
</div>
<p>If we look in <code class="docutils literal notranslate"><span class="pre">time_series_reader_logic.py</span></code> for example, we see the following class has been declared:</p>
<div class="literal-block-wrapper docutils container" id="id21">
<div class="code-block-caption"><span class="caption-number">Listing 1 </span><span class="caption-text">src/qudi/logic/time_series_reader_logic.py</span><a class="headerlink" href="#id21" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">TimeSeriesReaderLogic</span><span class="p">(</span><span class="n">LogicBase</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This logic module gathers data from a hardware streaming device.</span>

<span class="sd">    Example config for copy-paste:</span>

<span class="sd">    time_series_reader_logic:</span>
<span class="sd">        module.Class: &#39;time_series_reader_logic.TimeSeriesReaderLogic&#39;</span>
<span class="sd">        options:</span>
<span class="sd">            max_frame_rate: 20  # optional (default: 20Hz)</span>
<span class="sd">            channel_buffer_size: 1048576  # optional (default: 1MSample)</span>
<span class="sd">            max_raw_data_bytes: 1073741824  # optional (default: 1GB)</span>
<span class="sd">        connect:</span>
<span class="sd">            streamer: &lt;streamer_name&gt;</span>
<span class="sd">    &quot;&quot;&quot;</span>
</pre></div>
</div>
</div>
<p>It inherits from <code class="docutils literal notranslate"><span class="pre">LogicBase</span></code>, so that’s a logic, and the developper gives some example configuration.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If inheritance in the context of programming does not mean anything to you, please read <a class="reference external" href="https://learnxinyminutes.com/python/">this short guide on Python programming</a>. In short, one of the powerful features of Object Oriented Programming is that the behavior of classes (the templates to create objects) can be inherited. This avoid repeating code that you already wrote. For example, you might write a class <code class="docutils literal notranslate"><span class="pre">Vehicle</span></code> and have children classes <code class="docutils literal notranslate"><span class="pre">Car</span></code>, and <code class="docutils literal notranslate"><span class="pre">Bicycle</span></code> inheriting it. This is done in Python by having the parent class in parentheses, as shown above for <code class="docutils literal notranslate"><span class="pre">TimeSeriesReaderLogic</span></code>. Say that the <code class="docutils literal notranslate"><span class="pre">Vehicle</span></code> class implements the <code class="docutils literal notranslate"><span class="pre">go_to</span></code> and <code class="docutils literal notranslate"><span class="pre">say_hi</span></code> methods. Both children classes <code class="docutils literal notranslate"><span class="pre">Car</span></code> and <code class="docutils literal notranslate"><span class="pre">Bicycle</span></code> have them available by default without you needing to rewrite them. That being said, you can decide to re-write some method in the children classes to specialize them. For example, the parent class might have the following definition:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">Vehicle</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">say_hi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hi, I am a vehicle!&quot;</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">go_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;My new position is </span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">!&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>and the children classes might choose to specialize only the <code class="docutils literal notranslate"><span class="pre">say_hi</span></code> method as:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">Bicycle</span><span class="p">(</span><span class="n">Vehicle</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">say_hi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># See: https://www.scientificamerican.com/article/a-human-on-a-bicycle-is-among-the-most-efficient-forms-of-travel-in-the/ </span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hi, I a human-powered transportation mean, actually one of the most efficient that exists!&quot;</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Car</span><span class="p">(</span><span class="n">Vehicle</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">say_hi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hi, I am an evil transportation mean that destroys cities and makes them unsafe!&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>while still keeping the original <code class="docutils literal notranslate"><span class="pre">go_to</span></code> method definition.</p>
</div>
<p>This means we could configure it as:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">logic</span><span class="p">:</span>
<span class="w">    </span><span class="nt">time_series_reader_logic</span><span class="p">:</span>
<span class="w">        </span><span class="nt">module.Class</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;time_series_reader_logic.TimeSeriesReaderLogic&#39;</span>
<span class="w">        </span><span class="nt">options</span><span class="p">:</span>
<span class="w">            </span><span class="nt">max_frame_rate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">20</span><span class="w">  </span><span class="c1"># optional (default: 20Hz)</span>
<span class="w">            </span><span class="nt">channel_buffer_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1048576</span><span class="w">  </span><span class="c1"># optional (default: 1MSample)</span>
<span class="w">            </span><span class="nt">max_raw_data_bytes</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1073741824</span><span class="w">  </span><span class="c1"># optional (default: 1GB)</span>
<span class="w">        </span><span class="nt">connect</span><span class="p">:</span>
<span class="w">            </span><span class="nt">streamer</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my_streamer</span>
</pre></div>
</div>
<p>You can see that <code class="docutils literal notranslate"><span class="pre">module.Class</span></code> corresponds to the Python path to reach this class. Also here are the options and connect sections.</p>
</section>
</section>
<section id="connectors">
<h3>Connectors<a class="headerlink" href="#connectors" title="Link to this heading">¶</a></h3>
<p>In the previous example configuration, there is a <code class="docutils literal notranslate"><span class="pre">connect</span></code> section. When Qudi initializes a module (more on that in a coming section), it looks for <strong>connectors</strong> in the class declaration and matches them with elements of the <code class="docutils literal notranslate"><span class="pre">connect</span></code> section of the configuration. If we look further in the source code of <code class="docutils literal notranslate"><span class="pre">TimeSeriesReaderLogic</span></code>, you’ll notice the following lines:</p>
<div class="literal-block-wrapper docutils container" id="id22">
<div class="code-block-caption"><span class="caption-number">Listing 2 </span><span class="caption-text">src/qudi/logic/time_series_reader_logic.py</span><a class="headerlink" href="#id22" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="c1"># declare connectors</span>
    <span class="n">_streamer</span> <span class="o">=</span> <span class="n">Connector</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;streamer&#39;</span><span class="p">,</span> <span class="n">interface</span><span class="o">=</span><span class="s1">&#39;DataInStreamInterface&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>which tells Qudi to initialize the <code class="docutils literal notranslate"><span class="pre">_streamer</span></code> attribute of the Python object corresponding to the module with a connector to the module listed as <code class="docutils literal notranslate"><span class="pre">streamer</span></code> in the <code class="docutils literal notranslate"><span class="pre">connect</span></code> part of the configuration section. In the example above, we have <code class="docutils literal notranslate"><span class="pre">streamer:</span> <span class="pre">my_streamer</span></code> which means that we want the connected module to be <code class="docutils literal notranslate"><span class="pre">my_streamer</span></code>. We need to declare and configure this module in the configuration file as well.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Accessing the connected module
When coding logics, if you need to refer to the connected module (in this example, the module <code class="docutils literal notranslate"><span class="pre">my_streamer</span></code>), you need to <em>de-reference</em> it through the connector. This means that in a method of <code class="docutils literal notranslate"><span class="pre">TimeSeriesReaderLogic</span></code> for example, you would need to do something like <code class="docutils literal notranslate"><span class="pre">self._streamer()</span></code> to access the module. <strong>Note the parentheses</strong>, forgetting them is a very common source of errors.</p>
</div>
<p>You will notice that there is a second argument to <code class="docutils literal notranslate"><span class="pre">Connector</span></code>: <code class="docutils literal notranslate"><span class="pre">interface</span></code>. It tells Qudi which interface the connected module must implement. Qudi will throw an error if you try to connect a module that does not satisfy this interface. For us, it means that we want to add to the configuration file a hardware that implements the <code class="docutils literal notranslate"><span class="pre">DataInStreamInterface</span></code>. We will do that in a moment.</p>
</section>
<section id="configuration-options">
<h3>Configuration options<a class="headerlink" href="#configuration-options" title="Link to this heading">¶</a></h3>
<p>Last, but not least, come the configuration options. They are static attributes that are defined directly in the configuration file. Typical use cases would include the USB address of a hardware, the default acquisition rate of an acquisition card, etc. Sticking with our <code class="docutils literal notranslate"><span class="pre">TimeSeriesReaderLogic</span></code> example, we have the possibility of configuring the maximum frame rate, the size of a channel buffer, and the maximum size of all data. Ideally these would be better documented. In practice you often need to read code to grasp what they do.</p>
<p>In the code, these are declared using <code class="docutils literal notranslate"><span class="pre">ConfigOption</span></code>, in a similar way to the connectors. For example for <code class="docutils literal notranslate"><span class="pre">TimeSeriesReaderLogic</span></code>:</p>
<div class="literal-block-wrapper docutils container" id="id23">
<div class="code-block-caption"><span class="caption-number">Listing 3 </span><span class="caption-text">src/qudi/logic/time_series_reader_logic.py</span><a class="headerlink" href="#id23" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="c1"># config options</span>
    <span class="n">_max_frame_rate</span> <span class="o">=</span> <span class="n">ConfigOption</span><span class="p">(</span><span class="s1">&#39;max_frame_rate&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">missing</span><span class="o">=</span><span class="s1">&#39;warn&#39;</span><span class="p">)</span>
    <span class="n">_channel_buffer_size</span> <span class="o">=</span> <span class="n">ConfigOption</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;channel_buffer_size&#39;</span><span class="p">,</span>
                                        <span class="n">default</span><span class="o">=</span><span class="mi">1024</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span>
                                        <span class="n">missing</span><span class="o">=</span><span class="s1">&#39;info&#39;</span><span class="p">,</span>
                                        <span class="n">constructor</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
    <span class="n">_max_raw_data_bytes</span> <span class="o">=</span> <span class="n">ConfigOption</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;max_raw_data_bytes&#39;</span><span class="p">,</span>
                                       <span class="n">default</span><span class="o">=</span><span class="mi">1024</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span>
                                       <span class="n">missing</span><span class="o">=</span><span class="s1">&#39;info&#39;</span><span class="p">,</span>
                                       <span class="n">constructor</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">name</span></code> and <code class="docutils literal notranslate"><span class="pre">default</span></code> arguments are self-explanatories. <code class="docutils literal notranslate"><span class="pre">missing</span></code> tells Qudi what to do if the value is absent from the configuration. For example you can have <code class="docutils literal notranslate"><span class="pre">'error'</span></code> if you want to throw an error if it is missing.</p>
</section>
<section id="interactive-time-let-s-finish-this-configuration-file">
<h3>Interactive time: Let’s finish this configuration file!<a class="headerlink" href="#interactive-time-let-s-finish-this-configuration-file" title="Link to this heading">¶</a></h3>
<p>For this part, you need a text editor. You can use VSCode, Notepad++, Vim, or even the notepad of your system. It helps if you have an editor that knows YAML syntax and can detect for you some errors. From my tests, Notepad++ and VSCode should detect correctly the file format. If it is not the case, see <a class="reference external" href="https://stackoverflow.com/questions/30775551/set-language-for-syntax-highlighting-in-visual-studio-code">this SO post for VSCode</a>, and for Notepad++, click on the bottom left of the window. <strong>Remember that YAML is very sensitive to indentation</strong>, use four spaces to avoid issues.</p>
<div class="exercise admonition" id="configuration">

<p class="admonition-title"><span class="caption-number">Exercise 1 </span></p>
<section id="exercise-content">
<p>Using what we just learned, complete this configuration file to have our logic working (<code class="docutils literal notranslate"><span class="pre">TimeSeriesReaderLogic</span></code>), with a GUI (<code class="docutils literal notranslate"><span class="pre">TimeSeriesGui</span></code>, you will find it in <code class="docutils literal notranslate"><span class="pre">src/qudi/gui/time_series/time_series_gui.py</span></code>), and a dummy hardware (<code class="docutils literal notranslate"><span class="pre">InStreamDummy</span></code>, you will find it in <code class="docutils literal notranslate"><span class="pre">src/qudi/hardware/dummy/data_instream_dummy.py</span></code>).</p>
<p>You can copy and paste this empty configuration file to start with:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">global</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># list of modules to load when starting</span>
<span class="w">    </span><span class="nt">startup_modules</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span>
<span class="w">    </span><span class="c1"># Server port for serving the active qudi module namespace locally (localhost).</span>
<span class="w">    </span><span class="c1"># Used by e.g. the Qudi jupyter kernel.</span>
<span class="w">    </span><span class="nt">namespace_server_port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">18861</span>
<span class="w">    </span><span class="c1"># Save data to daily data sub-directories by default</span>
<span class="w">    </span><span class="nt">daily_data_dirs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">True</span>
<span class="nt">gui</span><span class="p">:</span>
<span class="nt">logic</span><span class="p">:</span>
<span class="nt">hardware</span><span class="p">:</span>
</pre></div>
</div>
</section>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You can test your solution by opening your file in Qudi’s main window!</p>
</div>
<p>Click on the block below to see a solution:</p>
<div class="solution dropdown admonition" id="configuration-solution">

<p class="admonition-title">Solution to<a class="reference internal" href="#configuration"> Exercise 1</a></p>
<section id="solution-content">
<p>Here’s one solution (directly from the default configuration).</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">global</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># list of modules to load when starting</span>
<span class="w">    </span><span class="nt">startup_modules</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;time_series_gui&#39;</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="c1"># Server port for serving the active qudi module namespace locally (localhost).</span>
<span class="w">    </span><span class="c1"># Used by e.g. the Qudi jupyter kernel.</span>
<span class="w">    </span><span class="nt">namespace_server_port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">18861</span>
<span class="w">    </span><span class="c1"># Save data to daily data sub-directories by default</span>
<span class="w">    </span><span class="nt">daily_data_dirs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">True</span>
<span class="nt">gui</span><span class="p">:</span>
<span class="w">    </span><span class="nt">time_series_gui</span><span class="p">:</span>
<span class="w">        </span><span class="nt">module.Class</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;time_series.time_series_gui.TimeSeriesGui&#39;</span>
<span class="w">        </span><span class="nt">options</span><span class="p">:</span>
<span class="w">            </span><span class="nt">use_antialias</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">True</span><span class="w">  </span><span class="c1"># optional, set to False if you encounter performance issues</span>
<span class="w">        </span><span class="nt">connect</span><span class="p">:</span>
<span class="w">            </span><span class="nt">_time_series_logic_con</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">time_series_reader_logic</span>
<span class="nt">logic</span><span class="p">:</span>
<span class="w">    </span><span class="nt">time_series_reader_logic</span><span class="p">:</span>
<span class="w">        </span><span class="nt">module.Class</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;time_series_reader_logic.TimeSeriesReaderLogic&#39;</span>
<span class="w">        </span><span class="nt">options</span><span class="p">:</span>
<span class="w">            </span><span class="nt">max_frame_rate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">20</span><span class="w">  </span><span class="c1"># optional (default: 20Hz)</span>
<span class="w">            </span><span class="nt">channel_buffer_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1048576</span><span class="w">  </span><span class="c1"># optional (default: 1MSample)</span>
<span class="w">            </span><span class="nt">max_raw_data_bytes</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1073741824</span><span class="w">  </span><span class="c1"># optional (default: 1GB)</span>
<span class="w">        </span><span class="nt">connect</span><span class="p">:</span>
<span class="w">            </span><span class="nt">streamer</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">instream_dummy</span>
<span class="nt">hardware</span><span class="p">:</span>
<span class="w">    </span><span class="nt">instream_dummy</span><span class="p">:</span>
<span class="w">        </span><span class="nt">module.Class</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;dummy.data_instream_dummy.InStreamDummy&#39;</span>
<span class="w">        </span><span class="nt">options</span><span class="p">:</span>
<span class="w">            </span><span class="nt">channel_names</span><span class="p">:</span>
<span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;digital</span><span class="nv"> </span><span class="s">1&#39;</span>
<span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;analog</span><span class="nv"> </span><span class="s">1&#39;</span>
<span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;analog</span><span class="nv"> </span><span class="s">2&#39;</span>
<span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;digital</span><span class="nv"> </span><span class="s">2&#39;</span>
<span class="w">            </span><span class="nt">channel_units</span><span class="p">:</span>
<span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;Hz&#39;</span>
<span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;V&#39;</span>
<span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;V&#39;</span>
<span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;Hz&#39;</span>
<span class="w">            </span><span class="nt">channel_signals</span><span class="p">:</span><span class="w">  </span><span class="c1"># Can be &#39;counts&#39; or &#39;sine&#39;</span>
<span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;counts&#39;</span>
<span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;sine&#39;</span>
<span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;sine&#39;</span>
<span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;counts&#39;</span>
<span class="w">            </span><span class="nt">data_type</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;float64&#39;</span>
<span class="w">            </span><span class="nt">sample_timing</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;CONSTANT&#39;</span><span class="w">  </span><span class="c1"># Can be &#39;CONSTANT&#39;, &#39;TIMESTAMP&#39; or &#39;RANDOM&#39;</span>
</pre></div>
</div>
</section>
</div>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>Please, run Qudi with this configuration now, we are going to use it in what comes next.</p>
</div>
</section>
</section>
<section id="qudi-s-main-window">
<h2>Qudi’s main window<a class="headerlink" href="#qudi-s-main-window" title="Link to this heading">¶</a></h2>
<p>If you load the solution to the previous exercise in Qudi, you will get two windows. Among them is Qudi’s main window:</p>
<figure class="align-default" id="id24">
<a class="reference internal image-reference" href="_images/main_window_annotated.svg"><img alt="_images/main_window_annotated.svg" src="_images/main_window_annotated.svg" style="width: 100%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 14 </span><span class="caption-text">The main window in Qudi</span><a class="headerlink" href="#id24" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>You can figure by yourself what is feasible with the menu bar and the toolbar, items have either a self-explanatory name, or an explanation label appearing when hovering the mouse above them.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>It is possible to change quite a lot what the main window looks like, moving stuff around, closing pannels  etc. If you get lost, you can restore the default view using the menu bar <kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">View</kbd> <kbd class="kbd docutils literal notranslate">&gt;</kbd> <kbd class="kbd docutils literal notranslate">Restore</kbd> <kbd class="kbd docutils literal notranslate">default</kbd></kbd>.</p>
</div>
<section id="log-viewer">
<span id="id6"></span><h3>Log viewer<a class="headerlink" href="#log-viewer" title="Link to this heading">¶</a></h3>
<p>A very helpful too is the log viewer, at the bottom of the window. This is where you can keep track of what is happening in Qudi. Each log entry is attributed a level: <code class="docutils literal notranslate"><span class="pre">debug</span></code>, <code class="docutils literal notranslate"><span class="pre">info</span></code>, <code class="docutils literal notranslate"><span class="pre">warning</span></code>, <code class="docutils literal notranslate"><span class="pre">error</span></code>, or <code class="docutils literal notranslate"><span class="pre">critical</span></code>. The <code class="docutils literal notranslate"><span class="pre">debug</span></code> level is only available if Qudi is started eith the <code class="docutils literal notranslate"><span class="pre">--debug</span></code> option. This pannel is especially important because this is where errors are reported.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>It can be very useful to read <a class="reference external" href="https://ulm-iqo.github.io/qudi-core/design_concepts/logging.html">section on logging in the Qudi documentation (link)</a>.</p>
</div>
<p>The logs are also systematically by Qudi and can be retrieved (this is particularly useful when an error causes Qudi to crash, or when reporting errors). They can be found in your home directory (for Linux and Mac users: <code class="docutils literal notranslate"><span class="pre">~/qudi/log</span></code>, for Windows users <code class="docutils literal notranslate"><span class="pre">C:/Users/&lt;you&gt;/qudi</span></code>). For example in my case I have the following files:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">qudi</span><span class="o">.</span><span class="n">log</span>  <span class="n">qudi</span><span class="o">.</span><span class="n">log</span><span class="mf">.1</span>  <span class="n">qudi</span><span class="o">.</span><span class="n">log</span><span class="mf">.2</span>  <span class="n">qudi</span><span class="o">.</span><span class="n">log</span><span class="mf">.3</span>  <span class="n">qudi</span><span class="o">.</span><span class="n">log</span><span class="mf">.4</span>  <span class="n">qudi</span><span class="o">.</span><span class="n">log</span><span class="mf">.5</span>
</pre></div>
</div>
<p>The most recent file is <code class="docutils literal notranslate"><span class="pre">qudi.log</span></code>, it contains the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>2025-11-27 12:35:21 info qudi.Qudi Starting qudi...
2025-11-27 12:35:21 info qudi.Qudi Applying configuration from &quot;/home/klafyvel/Documents/qudi-lab-on-a-molecule-modules/exercise_1.cfg&quot;...
2025-11-27 12:35:21 info qudi.Qudi Qudi configuration complete!
2025-11-27 12:35:21 info qudi.core.gui.gui Activating main GUI module...
2025-11-27 12:35:21 info qudi.core.servers Starting RPyC server &quot;local-namespace-server&quot; on [localhost]:18861
2025-11-27 12:35:21 info qudi.core.gui.main_gui.main_gui.QudiMainGui IPython kernel for qudi main GUI successfully started.
2025-11-27 12:35:21 info qudi.Qudi Loading startup module: time_series_gui
2025-11-27 12:35:21 info qudi.core.modulemanager Activating gui module &quot;time_series.time_series_gui.TimeSeriesGui&quot;
2025-11-27 12:35:22 info qudi.core.modulemanager Activating logic module &quot;time_series_reader_logic.TimeSeriesReaderLogic&quot;
2025-11-27 12:35:22 info qudi.core.modulemanager Activating hardware module &quot;dummy.data_instream_dummy.InStreamDummy&quot;
2025-11-27 12:35:23 info qudi.Qudi Initialization complete! Starting Qt event loop...
2025-11-27 12:35:24 info qudi.core.services Client connected to local module service from [127.0.0.1]:42718
2025-11-27 14:26:33 warning qudi.logic.time_series_reader_logic.TimeSeriesReaderLogic Moving average width (9) is smaller than the trace window size. Will adjust trace window size to match.
</pre></div>
</div>
<p>You can see that we retrieve all the informations displayed in the main window.</p>
</section>
<section id="python-console">
<h3>Python console<a class="headerlink" href="#python-console" title="Link to this heading">¶</a></h3>
<p>The Python console allows you to directly interact with the active module (more on activation in the next section). For example, you can query the <code class="docutils literal notranslate"><span class="pre">time_series_reader_logic</span></code> for the current trace data:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="n">time_series_reader_logic</span><span class="o">.</span><span class="n">trace_data</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">5</span><span class="p">]:</span> 
<span class="p">(</span><span class="n">array</span><span class="p">([</span><span class="o">...</span><span class="p">]),</span> <span class="p">{</span><span class="s1">&#39;digital 1&#39;</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="o">...</span><span class="p">]),</span> <span class="s1">&#39;analog 1&#39;</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="o">...</span><span class="p">]),</span> <span class="s1">&#39;analog 2&#39;</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="o">...</span><span class="p">]),</span> <span class="s1">&#39;digital 2&#39;</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="o">...</span><span class="p">])})</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Of course, to understand what this does, you need to read the documentation of the <code class="docutils literal notranslate"><span class="pre">trace_data</span></code> method of <code class="docutils literal notranslate"><span class="pre">TimeSeriesReaderLogic</span></code>. In this specific case, the implementation looks like:</p>
<div class="literal-block-wrapper docutils container" id="id25">
<div class="code-block-caption"><span class="caption-number">Listing 4 </span><span class="caption-text">src/qudi/logic/time_series_reader_logic.py</span><a class="headerlink" href="#id25" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">trace_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Read-only property returning the x-axis of the data trace and a dictionary of the</span>
<span class="sd">        corresponding trace data arrays for each channel</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trace_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_moving_average_width</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="n">ch</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trace_data</span><span class="p">[:</span><span class="n">data_offset</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ch</span> <span class="ow">in</span>
                <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">active_channel_names</span><span class="p">)}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trace_times</span><span class="p">,</span> <span class="n">data</span>
</pre></div>
</div>
</div>
<p>which is self explanatory.</p>
</div>
</section>
<section id="the-life-of-a-qudi-module-activation-and-de-activation">
<h3>The life of a Qudi module: activation and de-activation<a class="headerlink" href="#the-life-of-a-qudi-module-activation-and-de-activation" title="Link to this heading">¶</a></h3>
<figure class="align-default" id="id26">
<a class="reference internal image-reference" href="_images/module_widget_annotated.svg"><img alt="_images/module_widget_annotated.svg" src="_images/module_widget_annotated.svg" style="width: 100%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 15 </span><span class="caption-text">The module widget</span><a class="headerlink" href="#id26" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>Perhaps the most interesting part of the main window is the modules tabs. Every modules present in the configuration file are listed there, and this is your first interaction point with them. At the moment, you should have three modules active: <code class="docutils literal notranslate"><span class="pre">time_series_gui</span></code>, <code class="docutils literal notranslate"><span class="pre">time_series_reader_logic</span></code>, and <code class="docutils literal notranslate"><span class="pre">instream_dummy</span></code>. They have been loaded automatically at startup, because our configuration file contains the following directive:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">global</span><span class="p">:</span>
<span class="w">    </span><span class="nt">startup_modules</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;time_series_gui&#39;</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
<p>Qudi saw that we requested <code class="docutils literal notranslate"><span class="pre">time_series_gui</span></code>, so it loaded all the modules it depends on by exploring the successive <code class="docutils literal notranslate"><span class="pre">connect</span></code> directive in the configuration. You can also de-activate a module by pressing the red cross. This will gently de-activate all the modules that depend on it. For example, if you press on the red cross in the hardware tab next to <code class="docutils literal notranslate"><span class="pre">instream_dummy</span></code>, you will deactivate all our modules.</p>
</section>
<section id="state-machines">
<h3>State machines<a class="headerlink" href="#state-machines" title="Link to this heading">¶</a></h3>
<p>Qudi modules’ life is ruled by a state machine. As physicists this is <a class="reference external" href="https://en.wikipedia.org/wiki/State_pattern">a software design pattern</a> that resonates a lot. When using this pattern, the state of the program is represented by a <strong>state machine</strong>. The program will have a different behavior depending on the <strong>state</strong> in which it currently is. For each of these states, there is a set of <strong>transitions</strong> possible towards other states. The state machine is typically represented y an oriented graph, such as below.</p>
<figure class="align-default" id="id27">
<a class="reference internal image-reference" href="_images/module_fsm_diagram.svg"><img alt="_images/module_fsm_diagram.svg" src="_images/module_fsm_diagram.svg" style="width: 80%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 16 </span><span class="caption-text">The state machine of a Qudi module (reproduced from <a class="reference external" href="https://ulm-iqo.github.io/qudi-core/design_concepts/measurement_modules.html">Qudi’s documentation</a>). The rectangles represent states, the arrows represent transitions. The black dot indicates the initial state.</span><a class="headerlink" href="#id27" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>All modules start in the <code class="docutils literal notranslate"><span class="pre">deactivated</span></code> state. Then, when we click on their button in the main window, or if they are configured to be launched at startup, Qudi will use the <code class="docutils literal notranslate"><span class="pre">activate</span></code> transition to put the module in the <code class="docutils literal notranslate"><span class="pre">idle</span></code> state. In doing so, it will call the <code class="docutils literal notranslate"><span class="pre">on_activate</span></code> method of the module. This method is responsible for the initialization of the module. For example, hardware modules use it to initialize their connection to physical instruments, logic modules may use it to initialize their data storage buffers, GUI modules their windows, etc… Similarly, wen we de-activate a module, Qudi will use the <code class="docutils literal notranslate"><span class="pre">deactivate</span></code> transition to bring it to the <code class="docutils literal notranslate"><span class="pre">deactivated</span></code> state. It will call the <code class="docutils literal notranslate"><span class="pre">on_deactivate</span></code> method of the module beforehand. In this method, modules typically disconnect from physical instruments, clear out buffer, maybe save some data, etc…</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>All Qudi modules <strong>must</strong> define an <code class="docutils literal notranslate"><span class="pre">on_activate</span></code> and <code class="docutils literal notranslate"><span class="pre">on_deactivate</span></code> methods, even if they are empty.</p>
</div>
<p>The last state is the <code class="docutils literal notranslate"><span class="pre">locked</span></code> state. It is typically used to signal Qudi that the module is in the process of acquiring data. If you try to deactivate a locked module, Qudi will complain.</p>
</section>
<section id="status-variables">
<span id="id7"></span><h3>Status variables<a class="headerlink" href="#status-variables" title="Link to this heading">¶</a></h3>
<p>Before calling the <code class="docutils literal notranslate"><span class="pre">on_activate</span></code> method, and after calling the <code class="docutils literal notranslate"><span class="pre">on_deactivate</span></code> method, Qudi performs some work. This includes loading and saving <strong>Status variables</strong>. These are variables that are not static configuration but that we want to keep between runs. For example, a scanning laser might want to remember the last scan range it used, the galvo mirror might need to remember it’s last position, etc.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Status variable are powerful, but they might be a source of errors. In particular, if a specific setting makes Qudi crash (whatever the reason might be), it can be an issue if it had been saved as a status variable. To counteract this, you can use the <kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">Clear</kbd> <kbd class="kbd docutils literal notranslate">status</kbd> <kbd class="kbd docutils literal notranslate">variables</kbd></kbd> button nect to the module name to remove all status variables associated with a module.</p>
</div>
<p>If you know what you are doing, it is also possible to manually edit the status variables when Qudi is off, they are saved as normal YAML files. On my computer they are in <code class="docutils literal notranslate"><span class="pre">~/.local/qudi</span></code>, they will be in a similar path in your home directory on other operating systems. For example the saved status variables for the time series logic look like this on my computer:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">active_channels</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">digital 1</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">analog 1</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">analog 2</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">digital 2</span>
<span class="nt">averaged_channels</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">digital 1</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">analog 1</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">analog 2</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">digital 2</span>
<span class="nt">data_rate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">50.0</span>
<span class="nt">moving_average_width</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">9</span>
<span class="nt">oversampling_factor</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="nt">trace_window_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.0</span>
</pre></div>
</div>
<p>It is important to do it only once Qudi is switched off, otherwise it will overwrite your modifications when you switch it off.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Qudi only saves the status variables when it exits normally. If it crashes or is exited brutally (from the task manager, or by closing the terminal in which it is running), nothing will be saved.</p>
</div>
</section>
</section>
<section id="saving-things">
<h2>Saving things<a class="headerlink" href="#saving-things" title="Link to this heading">¶</a></h2>
<p>One great functionality of Qudi is it’s ability to save data from multiple instruments in a consistent way. You can configure it to have a daily directory, in which each module saving data has its own directory. Qudi also names the data files univocally, so you can understand what it is and when it was produced only with the file name. For example, our data directory looks something like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>.
├── 2024
│   ├── ...
│   ...
└── 2025
    ├── 04
    │   ├── 2025-04-15
    │   │   ├── matisse_excitation_logic
    │   │   ├── powermeter_time_series_logic
    │   │   ├── qdplot_logic
    │   │   ├── scanning_data_logic
    │   │   └── time_series_reader_logic
    │   ...
    └── 07    
        └── 2025-07-22
            ├── camera
            ├── dfb_excitation_logic
            ├── powermeter_time_series_logic
            ├── qdplot_logic
            └── time_series_reader_logic
</pre></div>
</div>
<p>And the files would be named like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">20250930</span><span class="o">-</span><span class="mi">1115</span><span class="o">-</span><span class="mi">41_2</span><span class="n">D</span><span class="o">-</span><span class="n">scan_with_xy_axes_from_channel_APD</span><span class="o">.</span><span class="n">dat</span>
<span class="mi">20250930</span><span class="o">-</span><span class="mi">1115</span><span class="o">-</span><span class="mi">41_2</span><span class="n">D</span><span class="o">-</span><span class="n">scan_with_xy_axes_from_channel_APD</span><span class="o">.</span><span class="n">png</span>
</pre></div>
</div>
<p>Where we have the date and time of saving, and a descriptive name. You can also see that many logics in Qudi save a basic plot of the data, which is very helpful to keep the labbook up to date, but also identify quickly datafiles.</p>
<p>This removes a lot of friction when saving data, as there are almost no decisions required when clicking <code class="docutils literal notranslate"><span class="pre">save</span></code>. Qudi also provides helpers to save data (typically Numpy arrays) with <strong>metadata</strong> (typically a dictionary). This means your file contains the experiment data, but also the settings of the instrument for example. There is also a mechanism to add <strong>global metadata</strong>, wich are metadata that are available globally. For example, the confocal scanner saves it’s current position in a global metadata each time there is a movement. This means that we have the position on the sample available in all data files saved by other logics.</p>
<p>Qudi provides natively several data formats for saving (<code class="docutils literal notranslate"><span class="pre">TextDataStorage</span></code>, <code class="docutils literal notranslate"><span class="pre">CsvDataStorage</span></code>, <code class="docutils literal notranslate"><span class="pre">NpyDataStorage</span></code>). You will often encouter the text data format. Please read the <a class="reference external" href="https://ulm-iqo.github.io/qudi-core/core_elements/data_storage.html">section on data storage</a> of the official Qudi documentation to see the options. In addition, the modules we developped at LENS use our own data format (<code class="docutils literal notranslate"><span class="pre">TOMLHeaderDataStorage</span></code>), which is very similar to the <code class="docutils literal notranslate"><span class="pre">TextDataStorage</span></code>, but uses a much more widely available format for the metadata (<a class="reference external" href="https://toml.io/en/">TOML, Tom’s Obvious Minimal Language</a>). A typical data file would look like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># [General]</span>
<span class="c1"># timestamp = 2025-10-01 11:39:56.535094</span>
<span class="c1"># delimiter = &quot;	&quot;</span>
<span class="c1"># comments = &quot;# &quot;</span>
<span class="c1"># column_dtypes = [</span>
<span class="c1">#     &quot;float&quot;,</span>
<span class="c1">#     &quot;float&quot;,</span>
<span class="c1">#     &quot;float&quot;,</span>
<span class="c1">#     &quot;float&quot;,</span>
<span class="c1"># ]</span>
<span class="c1"># column_headers = [</span>
<span class="c1">#     &quot;Frequency (Hz)&quot;,</span>
<span class="c1">#     &quot;pfi3 (c/s)&quot;,</span>
<span class="c1">#     &quot;Step number ()&quot;,</span>
<span class="c1">#     &quot;Time (s)&quot;,</span>
<span class="c1"># ]</span>
<span class="c1"># notes = &quot;free spad\nP=480nW\nT=5K\nwith BS&quot;</span>
<span class="c1"># ... more metadata, prefixed with a `#`</span>
<span class="c1"># ---- END HEADER ----</span>
<span class="o">-</span><span class="mf">2.000000000000000e+10</span>	<span class="mf">7.400000000000000e+02</span>	<span class="mf">0.000000000000000e+00</span>	<span class="mf">5.314013700000942e+00</span>
<span class="o">-</span><span class="mf">1.998998998998999e+10</span>	<span class="mf">5.700000000000000e+02</span>	<span class="mf">0.000000000000000e+00</span>	<span class="mf">5.414013700000941e+00</span>
<span class="o">-</span><span class="mf">1.997997997997998e+10</span>	<span class="mf">5.500000000000000e+02</span>	<span class="mf">0.000000000000000e+00</span>	<span class="mf">5.514013700000942e+00</span>
<span class="o">-</span><span class="mf">1.996996996996997e+10</span>	<span class="mf">6.200000000000000e+02</span>	<span class="mf">0.000000000000000e+00</span>	<span class="mf">5.614013700000942e+00</span>
<span class="o">-</span><span class="mf">1.995995995995996e+10</span>	<span class="mf">6.000000000000000e+02</span>	<span class="mf">0.000000000000000e+00</span>	<span class="mf">5.714013700000942e+00</span>
<span class="o">-</span><span class="mf">1.994994994994995e+10</span>	<span class="mf">6.800000000000000e+02</span>	<span class="mf">0.000000000000000e+00</span>	<span class="mf">5.814013700000942e+00</span>
<span class="o">-</span><span class="mf">1.993993993993994e+10</span>	<span class="mf">4.600000000000000e+02</span>	<span class="mf">0.000000000000000e+00</span>	<span class="mf">5.914013700000941e+00</span>
<span class="o">...</span> <span class="n">more</span> <span class="n">data</span>
</pre></div>
</div>
<p>Saving data can be done programatically fairly easily. First, you need to initialize your storage object. It will handle the saving for you:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">qudi.util.datastorage</span><span class="w"> </span><span class="kn">import</span> <span class="n">ImageFormat</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qudi.util.tomldatastorage</span><span class="w"> </span><span class="kn">import</span> <span class="n">TOMLHeaderDataStorage</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="c1"># You could also use the native Qudi Text storage:</span>
<span class="c1"># from qudi.util.datastorage import TextDataStorage</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">qudi.util.paths</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_default_data_dir</span><span class="p">,</span> <span class="n">get_daily_directory</span> <span class="c1"># To ask Qudi where to save these data</span>

<span class="c1"># Instantiate text storage object and configure it</span>
<span class="n">data_storage</span> <span class="o">=</span> <span class="n">TOMLHeaderDataStorage</span><span class="p">(</span>
    <span class="c1"># This will reproduce the common behavior in Qudi&#39;s logics</span>
    <span class="n">root_dir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">get_default_data_dir</span><span class="p">(),</span> <span class="n">get_daily_directory</span><span class="p">()),</span> 
    <span class="n">comments</span><span class="o">=</span><span class="s1">&#39;# &#39;</span><span class="p">,</span> 
    <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span>
    <span class="n">file_extension</span><span class="o">=</span><span class="s1">&#39;.dat&#39;</span><span class="p">,</span>
    <span class="n">column_formats</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;.8f&#39;</span><span class="p">,</span> <span class="s1">&#39;.15e&#39;</span><span class="p">),</span>
    <span class="n">include_global_metadata</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">image_format</span><span class="o">=</span><span class="n">ImageFormat</span><span class="o">.</span><span class="n">PNG</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Then, you can save your data, including the metadata. Here is an example taken from the documentation:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>

<span class="c1"># Create example data</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>  <span class="c1"># 1 sec time interval</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>  <span class="c1"># 2 Hz sine wave</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>  <span class="c1"># Format data into a single 2D array with x being the first </span>
                                       <span class="c1"># column and y being the second column</span>
                                       
<span class="c1"># Prepare a dict containing metadata to be saved in the file header</span>
<span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sample_number&#39;</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span>
            <span class="s1">&#39;batch&#39;</span>        <span class="p">:</span> <span class="s1">&#39;xyz-123&#39;</span><span class="p">}</span>

<span class="c1"># Create an explicit timestamp.</span>
<span class="n">timestamp</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>  <span class="c1"># 06.05.2021 at 11h:11m:11s</span>
<span class="c1"># timestamp = datetime.now()  # Usually you would use this</span>

<span class="c1"># Create a nametag to include in the file name (optional)</span>
<span class="n">nametag</span> <span class="o">=</span> <span class="s1">&#39;amplitude_measurement&#39;</span>

<span class="c1"># Create an iterable of data column header strings (optional)</span>
<span class="n">column_headers</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;time (s)&#39;</span><span class="p">,</span> <span class="s1">&#39;amplitude (V)&#39;</span><span class="p">)</span>

<span class="c1"># Create an arbitrary string of informal &quot;lab notes&quot; that is included in the file header</span>
<span class="n">notes</span> <span class="o">=</span> <span class="s1">&#39;This measurement was performed under the influence of 10 mugs of coffee and no sleep.&#39;</span>

<span class="c1"># Save data to file</span>
<span class="n">file_path</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">,</span> <span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">columns</span><span class="p">)</span> <span class="o">=</span> <span class="n">data_storage</span><span class="o">.</span><span class="n">save_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> 
                                                               <span class="n">timestamp</span><span class="o">=</span><span class="n">timestamp</span><span class="p">,</span> 
                                                               <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span> 
                                                               <span class="n">notes</span><span class="o">=</span><span class="n">notes</span><span class="p">,</span>
                                                               <span class="n">nametag</span><span class="o">=</span><span class="n">nametag</span><span class="p">,</span>
                                                               <span class="n">column_headers</span><span class="o">=</span><span class="n">column_headers</span><span class="p">,</span>
                                                               <span class="n">column_dtypes</span><span class="o">=</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>If you open the following file (run the cell to know where it is for you!), you’ll see what got saved:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">file_path</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;/home/klafyvel/qudi/Data/2025/12/2025-12-16/20210506-1111-11_amplitude_measurement.dat&#39;
</pre></div>
</div>
</div>
</div>
<p>Here is the beginning of the file as it appears for me:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># [General]</span>
<span class="c1"># timestamp = 2021-05-06 11:11:11</span>
<span class="c1"># delimiter = &quot;	&quot;</span>
<span class="c1"># comments = &quot;# &quot;</span>
<span class="c1"># column_dtypes = [</span>
<span class="c1">#     &quot;float&quot;,</span>
<span class="c1">#     &quot;float&quot;,</span>
<span class="c1"># ]</span>
<span class="c1"># column_headers = &quot;(&#39;time (s)&#39;, &#39;amplitude (V)&#39;)&quot;</span>
<span class="c1"># notes = &quot;This measurement was performed under the influence of 10 mugs of coffee and no sleep.&quot;</span>
<span class="c1"># </span>
<span class="c1"># [Metadata]</span>
<span class="c1"># sample_number = 42</span>
<span class="c1"># batch = &quot;xyz-123&quot;</span>
<span class="c1"># ---- END HEADER ----</span>
<span class="mf">0.00000000</span>	<span class="mf">0.000000000000000e+00</span>
<span class="mf">0.00100100</span>	<span class="mf">1.257861783874106e-02</span>
<span class="mf">0.00200200</span>	<span class="mf">2.515524538937585e-02</span>
</pre></div>
</div>
<p>You can also use the data storage to save a plot of the data. Qudi calls them thumbnails.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pl</span>

<span class="c1"># Create figure and plot data</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time (s)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;amplitude (V)&#39;</span><span class="p">)</span>

<span class="c1"># Save figure as thumbnail with the same file name as the corresponding data file</span>
<span class="n">figure_path</span> <span class="o">=</span> <span class="n">data_storage</span><span class="o">.</span><span class="n">save_thumbnail</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">file_path</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>If you open the file situated at (run the following cell to know where it is for you!):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">figure_path</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;/home/klafyvel/qudi/Data/2025/12/2025-12-16/20210506-1111-11_amplitude_measurement.png&#39;
</pre></div>
</div>
</div>
</div>
<p>You will see the thumbnail of your data file!</p>
</section>
<section id="scripting-qudi-using-jupyter-notebooks">
<span id="scripting"></span><h2>Scripting Qudi using Jupyter notebooks<a class="headerlink" href="#scripting-qudi-using-jupyter-notebooks" title="Link to this heading">¶</a></h2>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>After changing the configuration, you may need to restart your Jupyter kernel using the menu: <kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">Kernel</kbd> <kbd class="kbd docutils literal notranslate">&gt;</kbd> <kbd class="kbd docutils literal notranslate">Restart</kbd> <kbd class="kbd docutils literal notranslate">Kernel</kbd></kbd>.</p>
</div>
<p>We’ve already started using notebook to script Qudi, but haven’t been interacting with the instruments yet! This is also possible in Qudi, and provides a nice trade-off between writing full-blown logic and GUI modules and not using automation at all.</p>
<p>To create a jupyter notebook that works with Qudi, you need to use the Qudi jupyter kernel. Using the jupyter installation provided with Qudi (check also the section “<a class="reference internal" href="#running-qudi-and-the-interactive-notes"><span class="std std-ref">Running Qudi and the interactive notes</span></a>), you can select this kernel when creating a new notebook.</p>
<figure class="align-default" id="id28">
<a class="reference internal image-reference" href="_images/new_notebook.png"><img alt="_images/new_notebook.png" src="_images/new_notebook.png" style="width: 200px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 17 </span><span class="caption-text">The <kbd class="kbd docutils literal notranslate">New</kbd> menu in the jupyter explorer allows selecting a kernel. If you are creating a new notebook for using Qudi, you must choose <code class="docutils literal notranslate"><span class="pre">qudi</span></code>.</span><a class="headerlink" href="#id28" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>You can check that you are running the correct kernel from the top-right section of the notebook. For example, if you are following along the tutorial using the notebook version of the notes, you should see the following:</p>
<figure class="align-default" id="id29">
<a class="reference internal image-reference" href="_images/running_notebook.png"><img alt="_images/running_notebook.png" src="_images/running_notebook.png" style="width: 200px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 18 </span><span class="caption-text">The notebook displays the currently used kernel, here the <code class="docutils literal notranslate"><span class="pre">qudi</span></code> kernel.</span><a class="headerlink" href="#id29" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you created a notebook using the wrong kernel, it is possible to change it by clicking on the name of the currently running kernel, or through the <kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">Kernel</kbd> <kbd class="kbd docutils literal notranslate">&gt;</kbd> <kbd class="kbd docutils literal notranslate">Change</kbd> <kbd class="kbd docutils literal notranslate">Kernel...</kbd></kbd> menu.</p>
</div>
<p>From there, you can interact with the modules <em>mostly</em> as if you were entering code in the IPython console of the main window, or writing code for a module. For example, we can try to list the available channels of the time-series logic.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">time_series_reader_logic</span><span class="o">.</span><span class="n">active_channel_names</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">time_series_reader_logic</span><span class="o">.</span><span class="n">active_channel_names</span>

<span class="ne">NameError</span>: name &#39;time_series_reader_logic&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Ideally, there would be documentation available for each of the methods of the logics. While there has been a good effort towards that, the documentation is not currently exported. This means you often need to read through the source code to understand what a method that you don’t know yet does. A good heuristic to know if you are supposed to be using a specific method is to check its name. A convention in Python is to prefix names of internal methods (methods that are supposed to be used only by the class itself, and not you, the final user) with and underscore <code class="docutils literal notranslate"><span class="pre">_</span></code>. For example, the time series logic has an <code class="docutils literal notranslate"><span class="pre">_init_data_arrays</span></code> that has no documentation and is meant to be used internally. On the other hand the <code class="docutils literal notranslate"><span class="pre">active_channel_names</span></code> is not prefixed and has documentation. It is meant to be used!</p>
</div>
<p>From there, you can do more interesting things, like starting and stopping acquisitions, setting parameters, etc… The following code snippet illustrates some of the capabilities.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">time_series_reader_logic</span><span class="o">.</span><span class="n">trace_window_size</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="c1"># Set the acquisition window length to 20 s</span>
<span class="n">time_series_reader_logic</span><span class="o">.</span><span class="n">data_rate</span> <span class="o">=</span> <span class="mf">50.0</span> <span class="c1"># Data acquisition rate to 50 Hz</span>
<span class="nb">print</span><span class="p">((</span>
    <span class="s2">&quot;The current oversampling factor is </span><span class="si">{oversampling_factor}</span><span class="s2">, &quot;</span>
    <span class="s2">&quot;the moving average width </span><span class="si">{moving_average_width}</span><span class="s2">s, &quot;</span>
    <span class="s2">&quot;the trace window size </span><span class="si">{trace_window_size}</span><span class="s2">s, &quot;</span>
    <span class="s2">&quot;and the data rate </span><span class="si">{data_rate}</span><span class="s2">Hz&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">**</span><span class="n">time_series_reader_logic</span><span class="o">.</span><span class="n">trace_settings</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The current oversampling factor is 1, the moving average width 9s, the trace window size 2.0s, and the data rate 50.0Hz
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

<span class="k">if</span> <span class="n">time_series_reader_logic</span><span class="o">.</span><span class="n">module_state</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;locked&quot;</span><span class="p">:</span> <span class="c1"># If acquisition is running,</span>
    <span class="n">time_series_reader_logic</span><span class="o">.</span><span class="n">stop_reading</span><span class="p">()</span> <span class="c1"># stop it.</span>

<span class="n">time_series_reader_logic</span><span class="o">.</span><span class="n">start_reading</span><span class="p">()</span> <span class="c1"># start acquisition</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># wait 1s</span>
<span class="n">time_series_reader_logic</span><span class="o">.</span><span class="n">stop_reading</span><span class="p">()</span> <span class="c1"># stop acquisition</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The code snippet above is bad practice and should only be considered an example. If you need to run synchronized acquisitions, or acquisitions where timing matters, you should rather use a hardware that implements <code class="docutils literal notranslate"><span class="pre">FiniteSamplingInputInterface</span></code>, or <code class="docutils literal notranslate"><span class="pre">FiniteSamplingIOInterface</span></code>. In particular, these are implemented for NIDaq instruments and allow using the hardware clock of the acquisition card, which is reliable. The <code class="docutils literal notranslate"><span class="pre">time.sleep</span></code> function in Python on the other hand, while convenient, is imprecise and relies on the operating system. Famously, Windows is extremely bad at providing reliable timings.</p>
</div>
<p>Now that our logic has aquired some data, we might want to use it. Of course, we could just make the logic save it using <code class="docutils literal notranslate"><span class="pre">time_series_reader_logic.save_trace_snapshot</span></code> and then reload it. However, another option is to transfer the data directly to the Jupyter notebook! First we load some packages to plot, deal with the data, and deal with data import:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pl</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qudi.util.network</span><span class="w"> </span><span class="kn">import</span> <span class="n">netobtain</span>
</pre></div>
</div>
</div>
</div>
<p>The very last line of the previous code snippet imports a function called <code class="docutils literal notranslate"><span class="pre">netobtain</span></code>. For ‘simple’ data types (like integers, floating point numbers…), the link between Qudi and the notebook is smart enough to transfer it. However, for more complicated objects like numpy arrays, this might not work. Thus, if you run the following snippet:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">time</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">time_series_reader_logic</span><span class="o">.</span><span class="n">trace_data</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;analog 1&#39;</span><span class="p">]</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  0.        ,  0.06698023,
        0.01506304,  3.64632618,  2.49793114,  3.48557959,  5.02556142,
        4.06057504,  4.73545865,  4.65371359,  3.48637932,  2.26034397,
        7.66790664,  2.94964391,  8.1436822 ,  7.93296847,  7.7837564 ,
        8.85416867,  8.88805818,  4.34097689,  5.97260568,  6.61344725,
        5.91208872,  8.86446977,  7.28261722,  7.46139949,  5.41658627,
        3.25366366,  5.66301532,  5.75595789,  2.86211996,  5.40552875,
        1.6837842 ,  5.74722921,  5.30131458,  3.78627703, -0.13560487,
        0.20616062,  1.63436477, -1.51085868,  0.22346584,  1.1943417 ,
       -2.64445668, -0.4621692 , -4.92496991, -2.29291868, -3.91197362])
</pre></div>
</div>
</div>
</div>
<p>It looks like the numpy array was successfully retrieved. However, if you try to plot it with matplotlib, you will get an error:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">12</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

<span class="nn">File ~/tmp/qudi-lab-on-a-molecule-modules/.venv/lib/python3.10/site-packages/matplotlib/pyplot.py:3838,</span> in <span class="ni">plot</span><span class="nt">(scalex, scaley, data, *args, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">3830</span> <span class="nd">@_copy_docstring_and_deprecators</span><span class="p">(</span><span class="n">Axes</span><span class="o">.</span><span class="n">plot</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3831</span> <span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">3832</span>     <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="n">ArrayLike</span> <span class="o">|</span> <span class="nb">str</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3836</span>     <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">3837</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Line2D</span><span class="p">]:</span>
<span class="ne">-&gt; </span><span class="mi">3838</span>     <span class="k">return</span> <span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">3839</span>         <span class="o">*</span><span class="n">args</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">3840</span>         <span class="n">scalex</span><span class="o">=</span><span class="n">scalex</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">3841</span>         <span class="n">scaley</span><span class="o">=</span><span class="n">scaley</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">3842</span>         <span class="o">**</span><span class="p">({</span><span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">data</span><span class="p">}</span> <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">{}),</span>
<span class="g g-Whitespace">   </span><span class="mi">3843</span>         <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">3844</span>     <span class="p">)</span>

<span class="nn">File ~/tmp/qudi-lab-on-a-molecule-modules/.venv/lib/python3.10/site-packages/matplotlib/axes/_axes.py:1779,</span> in <span class="ni">Axes.plot</span><span class="nt">(self, scalex, scaley, data, *args, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">1777</span> <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_lines</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)]</span>
<span class="g g-Whitespace">   </span><span class="mi">1778</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1779</span>     <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1780</span> <span class="k">if</span> <span class="n">scalex</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1781</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_request_autoscale_view</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>

<span class="nn">File ~/tmp/qudi-lab-on-a-molecule-modules/.venv/lib/python3.10/site-packages/matplotlib/axes/_base.py:2417,</span> in <span class="ni">_AxesBase.add_line</span><span class="nt">(self, line)</span>
<span class="g g-Whitespace">   </span><span class="mi">2414</span> <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">get_clip_path</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">2415</span>     <span class="n">line</span><span class="o">.</span><span class="n">set_clip_path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">patch</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">2417</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_line_limits</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2418</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="o">.</span><span class="n">get_label</span><span class="p">():</span>
<span class="g g-Whitespace">   </span><span class="mi">2419</span>     <span class="n">line</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;_child</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="nn">File ~/tmp/qudi-lab-on-a-molecule-modules/.venv/lib/python3.10/site-packages/matplotlib/axes/_base.py:2440,</span> in <span class="ni">_AxesBase._update_line_limits</span><span class="nt">(self, line)</span>
<span class="g g-Whitespace">   </span><span class="mi">2436</span> <span class="k">def</span><span class="w"> </span><span class="nf">_update_line_limits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">2437</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">2438</span><span class="sd">     Figures out the data limit of the given line, updating `.Axes.dataLim`.</span>
<span class="g g-Whitespace">   </span><span class="mi">2439</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">-&gt; </span><span class="mi">2440</span>     <span class="n">path</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">get_path</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">2441</span>     <span class="k">if</span> <span class="n">path</span><span class="o">.</span><span class="n">vertices</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">2442</span>         <span class="k">return</span>

<span class="nn">File ~/tmp/qudi-lab-on-a-molecule-modules/.venv/lib/python3.10/site-packages/matplotlib/lines.py:1052,</span> in <span class="ni">Line2D.get_path</span><span class="nt">(self)</span>
<span class="g g-Whitespace">   </span><span class="mi">1050</span><span class="w"> </span><span class="sd">&quot;&quot;&quot;Return the `~matplotlib.path.Path` associated with this line.&quot;&quot;&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1051</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_invalidy</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_invalidx</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1052</span>     <span class="bp">self</span><span class="o">.</span><span class="n">recache</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">1053</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path</span>

<span class="nn">File ~/tmp/qudi-lab-on-a-molecule-modules/.venv/lib/python3.10/site-packages/matplotlib/lines.py:689,</span> in <span class="ni">Line2D.recache</span><span class="nt">(self, always)</span>
<span class="g g-Whitespace">    </span><span class="mi">687</span> <span class="k">if</span> <span class="n">always</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_invalidx</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">688</span>     <span class="n">xconv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_xunits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_xorig</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">689</span>     <span class="n">x</span> <span class="o">=</span> <span class="n">_to_unmasked_float_array</span><span class="p">(</span><span class="n">xconv</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">690</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">691</span>     <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x</span>

<span class="nn">File ~/tmp/qudi-lab-on-a-molecule-modules/.venv/lib/python3.10/site-packages/matplotlib/cbook.py:1355,</span> in <span class="ni">_to_unmasked_float_array</span><span class="nt">(x)</span>
<span class="g g-Whitespace">   </span><span class="mi">1353</span>     <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">filled</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1354</span> <span class="k">else</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1355</span>     <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>

<span class="ne">TypeError</span>: _make_method.&lt;locals&gt;.__array__() takes 1 positional argument but 2 were given
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/5d464bbe39be8fa926bd0262d0f941601183dfd63d70d4ffa0807a0ef63efc94.png"><img alt="_images/5d464bbe39be8fa926bd0262d0f941601183dfd63d70d4ffa0807a0ef63efc94.png" src="_images/5d464bbe39be8fa926bd0262d0f941601183dfd63d70d4ffa0807a0ef63efc94.png" style="width: 60%;" />
</a>
</div>
</div>
<p>Unfortunately, this error is particularly difficult to read. I expect that in future versions of Qudi this kind of issues will be fixed. To understand where this comes from, you can examine what exactly is the type of <code class="docutils literal notranslate"><span class="pre">data</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;netref class &#39;rpyc.core.netref.type&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p>As you can see, this is unexpected, as we thought we would be getting a Numpy array. The solution is to use <code class="docutils literal notranslate"><span class="pre">netobtain</span></code> to retrieve the complete object:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">time</span> <span class="o">=</span> <span class="n">netobtain</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">netobtain</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;numpy.ndarray&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p>Now <code class="docutils literal notranslate"><span class="pre">data</span></code> is indeed a Numpy array, and can be used for plotting:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time [s]&quot;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Analog value [V]&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Analog value [V]&#39;)
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/650f9320defd08d9998f7c1d5dddaaad0d7b784fc9f44cf85c6bbb5aed9a5395.png"><img alt="_images/650f9320defd08d9998f7c1d5dddaaad0d7b784fc9f44cf85c6bbb5aed9a5395.png" src="_images/650f9320defd08d9998f7c1d5dddaaad0d7b784fc9f44cf85c6bbb5aed9a5395.png" style="width: 60%;" />
</a>
</div>
</div>
</section>
</section>
<section id="when-things-go-wrong-understanding-errors">
<h1>When things go wrong: understanding errors<a class="headerlink" href="#when-things-go-wrong-understanding-errors" title="Link to this heading">¶</a></h1>
<figure class="align-default">
<a class="reference internal image-reference" href="_images/fallen_me.jpeg"><img alt="a character has fallen on the ground and is dizzy. Next to them is a smoking laptop." src="_images/fallen_me.jpeg" style="width: 30%;" />
</a>
</figure>
<p>However hard you work to make everything alright, you will encounter errors. In this section, I list common errors I have seen and how to deal with them. This is not, by any way, exhaustive. In the last part I will discuss a bit how to deal with the unexpected, how to report issues, and how to get help.</p>
<section id="finding-useful-errors-finding-errors-useful">
<h2>Finding useful errors / finding errors useful<a class="headerlink" href="#finding-useful-errors-finding-errors-useful" title="Link to this heading">¶</a></h2>
<p>The first step to understanding, and hopefully fixing, errors is to be able to find and identify errors. The first place you want to look at is the logger in the main window. Qudi modules are able to communicate with it and output there error messages. Actually, we can print one right now! If you execute the following code snippet:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">instream_dummy</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Hey, I am an error message!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>You will see the following message in the logger:</p>
<figure class="align-default" id="id30">
<a class="reference internal image-reference" href="_images/error_message_main_window.png"><img alt="_images/error_message_main_window.png" src="_images/error_message_main_window.png" style="width: 80%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 19 </span><span class="caption-text">The error message we just printed!</span><a class="headerlink" href="#id30" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>You can double click on the message to copy and paste it to report it, or look for solutions online for example. You can see that Qudi tells you which Python module produced the message and at which time. This kind of error message happens when the person that coded the module anticipated that an error could occur and decided to alert the user. This means it is up to the programmer to make the error message useful in helping you fix the error!</p>
<p>If you have a look at the terminal in which Qudi is running, you will see that the error message also appears there, albeit with less informations available.</p>
<figure class="align-default" id="id31">
<a class="reference internal image-reference" href="_images/error_message_terminal.png"><img alt="_images/error_message_terminal.png" src="_images/error_message_terminal.png" style="width: 30%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 20 </span><span class="caption-text">The error message in the terminal</span><a class="headerlink" href="#id31" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>This redundancy is useful if the main window comes to crash for example. The last place where you can find errors is in the log file (see <a class="reference internal" href="#log-viewer"><span class="std std-ref">Log viewer</span></a> section to locate this file). Always with our example, Qudi outputed the following line in my file when I ran it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>2025-12-14 16:31:40 error qudi.hardware.dummy.data_instream_dummy.InStreamDummy Hey, I am an error message!
</pre></div>
</div>
<p>As you can see, we retrieve the same pieces of information as in the main window. This is also useful if the main window becomes unavailable, or if you closed it before reporting the error.</p>
<p>A second kind of error message that you can find is a Python exception report. This typically happens when the person who coded the modules you are using did not anticipate an error, but Qudi was able to catch it.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When a Python error happens the flow of the program execution is cut, sometimes abruptly, which means it is harder to ensure that the program is in a consistent state. It might be safer in this case to restart the execution from scratch!</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For advanced users, and users who will code their own modules.
Qudi is rather good at catching errors. However, some error will fail silently and can be hard to debug. This is especially the case when some code is not running in the main thread. For these specific cases, the easiest solution I have found for now is to print regularly bits of informations in the logger to detect errors.</p>
</div>
<p>Although this is probably something you already know, it is worth spending one minute to remind you how to read a Python error. First, let’s trigger an error with our current configuration, using the <code class="docutils literal notranslate"><span class="pre">instream_dummy</span></code> hardware. This hardware will refuse to read data if an acquisition is not running. Let’s try the following code snippet:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">time_series_reader_logic</span><span class="o">.</span><span class="n">stop_reading</span><span class="p">()</span> <span class="c1"># make sure no acquisition is running. </span>
<span class="n">instream_dummy</span><span class="o">.</span><span class="n">read_data</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="c1"># read 10 data points</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">RuntimeError</span><span class="g g-Whitespace">                              </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">17</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">time_series_reader_logic</span><span class="o">.</span><span class="n">stop_reading</span><span class="p">()</span> <span class="c1"># make sure no acquisition is running. </span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">instream_dummy</span><span class="o">.</span><span class="n">read_data</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="c1"># read 10 data points</span>

<span class="nn">File ~/tmp/qudi-lab-on-a-molecule-modules/.venv/lib/python3.10/site-packages/rpyc/core/netref.py:240,</span> in <span class="ni">_make_method.&lt;locals&gt;.__call__</span><span class="nt">(_self, *args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">238</span> <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="n">_self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">239</span>     <span class="n">kwargs</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
<span class="ne">--&gt; </span><span class="mi">240</span>     <span class="k">return</span> <span class="n">syncreq</span><span class="p">(</span><span class="n">_self</span><span class="p">,</span> <span class="n">consts</span><span class="o">.</span><span class="n">HANDLE_CALL</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File ~/tmp/qudi-lab-on-a-molecule-modules/.venv/lib/python3.10/site-packages/rpyc/core/netref.py:63,</span> in <span class="ni">syncreq</span><span class="nt">(proxy, handler, *args)</span>
<span class="g g-Whitespace">     </span><span class="mi">51</span><span class="w"> </span><span class="sd">&quot;&quot;&quot;Performs a synchronous request on the given proxy object.</span>
<span class="g g-Whitespace">     </span><span class="mi">52</span><span class="sd"> Not intended to be invoked directly.</span>
<span class="g g-Whitespace">     </span><span class="mi">53</span><span class="sd"> </span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">     </span><span class="mi">60</span><span class="sd"> :returns: the result of the operation</span>
<span class="g g-Whitespace">     </span><span class="mi">61</span><span class="sd"> &quot;&quot;&quot;</span>
<span class="g g-Whitespace">     </span><span class="mi">62</span> <span class="n">conn</span> <span class="o">=</span> <span class="nb">object</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="n">proxy</span><span class="p">,</span> <span class="s2">&quot;____conn__&quot;</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">63</span> <span class="k">return</span> <span class="n">conn</span><span class="o">.</span><span class="n">sync_request</span><span class="p">(</span><span class="n">handler</span><span class="p">,</span> <span class="n">proxy</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>

<span class="nn">File ~/tmp/qudi-lab-on-a-molecule-modules/.venv/lib/python3.10/site-packages/rpyc/core/protocol.py:718,</span> in <span class="ni">Connection.sync_request</span><span class="nt">(self, handler, *args)</span>
<span class="g g-Whitespace">    </span><span class="mi">715</span> <span class="n">_async_res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">async_request</span><span class="p">(</span><span class="n">handler</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">716</span> <span class="c1"># _async_res is an instance of AsyncResult, the value property invokes Connection.serve via AsyncResult.wait</span>
<span class="g g-Whitespace">    </span><span class="mi">717</span> <span class="c1"># So, the _recvlock can be acquired multiple times by the owning thread and warrants the use of RLock</span>
<span class="ne">--&gt; </span><span class="mi">718</span> <span class="k">return</span> <span class="n">_async_res</span><span class="o">.</span><span class="n">value</span>

<span class="nn">File ~/tmp/qudi-lab-on-a-molecule-modules/.venv/lib/python3.10/site-packages/rpyc/core/async_.py:108,</span> in <span class="ni">AsyncResult.value</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">106</span> <span class="bp">self</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">107</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_exc</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">108</span>     <span class="k">raise</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span>
<span class="g g-Whitespace">    </span><span class="mi">109</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">110</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span>

<span class="ne">RuntimeError</span>: Unable to read data. Stream is not running.

<span class="o">=========</span> <span class="n">Remote</span> <span class="n">Traceback</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=========</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="s2">&quot;/home/klafyvel/Documents/qudi-lab-on-a-molecule-modules/.venv/lib/python3.10/site-packages/rpyc/core/protocol.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">359</span><span class="p">,</span> <span class="ow">in</span> <span class="n">_dispatch_request</span>
    <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_HANDLERS</span><span class="p">[</span><span class="n">handler</span><span class="p">](</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
  <span class="n">File</span> <span class="s2">&quot;/home/klafyvel/Documents/qudi-lab-on-a-molecule-modules/.venv/lib/python3.10/site-packages/rpyc/core/protocol.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">837</span><span class="p">,</span> <span class="ow">in</span> <span class="n">_handle_call</span>
    <span class="k">return</span> <span class="n">obj</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="nb">dict</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
  <span class="n">File</span> <span class="s2">&quot;/home/klafyvel/Documents/qudi-lab-on-a-molecule-modules/.venv/lib/python3.10/site-packages/qudi/core/services.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">274</span><span class="p">,</span> <span class="ow">in</span> <span class="n">wrapped</span>
    <span class="k">return</span> <span class="n">attr</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
  <span class="n">File</span> <span class="s2">&quot;/home/klafyvel/Documents/qudi-lab-on-a-molecule-modules/src/qudi/hardware/dummy/data_instream_dummy.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">544</span><span class="p">,</span> <span class="ow">in</span> <span class="n">read_data</span>
    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Unable to read data. Stream is not running.&#39;</span><span class="p">)</span>
<span class="ne">RuntimeError</span>: Unable to read data. Stream is not running.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Qudi IPython kernel disconnected from local module service.
</pre></div>
</div>
</div>
</div>
<p>Everything exploded! Since we are running code in a notebook, two errors are reported. One is local to the notebook (the first one) and you can ignore it, and the other corresponds to the error in Qudi (you can see that it mention a <code class="docutils literal notranslate"><span class="pre">Remote</span> <span class="pre">Traceback</span></code>, this is because the Python instance that runs Qudi is considered a remote excecution thread by the notebook). If Qudi had caught this error in a module (for example if your logic module was flawed), it would have only printed the last bit in the log viewer. Let’s try to go through this error to learn to read it.</p>
<figure class="align-default" id="id32">
<a class="reference internal image-reference" href="_images/python_error.png"><img alt="_images/python_error.png" src="_images/python_error.png" style="width: 100%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 21 </span><span class="caption-text">The error message with flashy colors. Everything is better in flashy colors. :)</span><a class="headerlink" href="#id32" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>The error should be read from bottom to top. The first, and maybe most important bit is the error name and the error message, highlighted in light blue. The error name gives you an idea of the kind of error that happened. Python provides <a class="reference external" href="https://docs.python.org/3/library/exceptions.html">a set of built-in exceptions</a>, and developpers are free to add their own. For example, a developper wanting to report an error related to a division by zero might use <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ZeroDivisionError"><code class="docutils literal notranslate"><span class="pre">ZeroDivisionError</span></code></a>. The message is a hint left by the developper to understand the origin and reason for the error to happen, and maybe help you fix it.</p>
<p>The second part of the error is the <strong>traceback</strong>. This is the list of successive calls that led to the error. The very last one is said to be on the top of the stack. A call report tells you in which file, line, and function the executed code can be found (in dark blue, orange, and green respectively). The code making the call is reported below in purple in by illustration.</p>
<p>As you can see the last call includes a <code class="docutils literal notranslate"><span class="pre">raise</span></code> statement, whose function is… to raise an error and interrupt the code execution. This call happened because of the call above, etc. If we had not deliberately triggered this error, we might use the traceback to track the origin of the error and perhaps fix it.</p>
</section>
<section id="configuration-file-errors">
<h2>Configuration file errors<a class="headerlink" href="#configuration-file-errors" title="Link to this heading">¶</a></h2>
<p>In this section, I list some common errors that can be linked to configuration files</p>
<figure class="align-default" id="id33">
<a class="reference internal image-reference" href="_images/wrong_configuration.jpeg"><img alt="A character is trying to connect two pieces of a puzzle that cannot fit together" src="_images/wrong_configuration.jpeg" style="width: 30%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 22 </span><span class="caption-text">Connectors must match the expected interfaces.</span><a class="headerlink" href="#id33" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<section id="wrong-interfaces">
<h3>Wrong interfaces<a class="headerlink" href="#wrong-interfaces" title="Link to this heading">¶</a></h3>
<p>As we discussed before, in Qudi the modules interact between each other through the defined interfaces. If you try to connect a module that does not implement the right interface, Qudi will yell at you. For example, if I try to connect a module that does not implement the <code class="docutils literal notranslate"><span class="pre">DataInStreamInterface</span></code>, I will get the following error:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2025</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">14</span> <span class="mi">18</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">37</span> <span class="n">error</span> <span class="n">qudi</span><span class="o">.</span><span class="n">Qudi</span> <span class="n">Unable</span> <span class="n">to</span> <span class="n">activate</span> <span class="n">autostart</span> <span class="n">module</span> <span class="s2">&quot;time_series_gui&quot;</span><span class="p">:</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="s2">&quot;[...]qudi/core/application.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">292</span><span class="p">,</span> <span class="ow">in</span> <span class="n">_start_startup_modules</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">module_manager</span><span class="o">.</span><span class="n">activate_module</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>
  <span class="n">File</span> <span class="s2">&quot;[...]qudi/core/modulemanager.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">208</span><span class="p">,</span> <span class="ow">in</span> <span class="n">activate_module</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_modules</span><span class="p">[</span><span class="n">module_name</span><span class="p">]</span><span class="o">.</span><span class="n">activate</span><span class="p">()</span>
  <span class="n">File</span> <span class="s2">&quot;[...]qudi/core/modulemanager.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">540</span><span class="p">,</span> <span class="ow">in</span> <span class="n">activate</span>
    <span class="n">module</span><span class="o">.</span><span class="n">activate</span><span class="p">()</span>
  <span class="n">File</span> <span class="s2">&quot;[...]qudi/core/modulemanager.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">543</span><span class="p">,</span> <span class="ow">in</span> <span class="n">activate</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_connect</span><span class="p">()</span>
  <span class="n">File</span> <span class="s2">&quot;[...]qudi/core/modulemanager.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">763</span><span class="p">,</span> <span class="ow">in</span> <span class="n">_connect</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_instance</span><span class="o">.</span><span class="n">connect_modules</span><span class="p">(</span><span class="n">module_connections</span><span class="p">)</span>
  <span class="n">File</span> <span class="s2">&quot;[...]qudi/core/module.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">416</span><span class="p">,</span> <span class="ow">in</span> <span class="n">connect_modules</span>
    <span class="n">conn</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
  <span class="n">File</span> <span class="s2">&quot;[...]qudi/core/connector.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">109</span><span class="p">,</span> <span class="ow">in</span> <span class="n">connect</span>
    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
<span class="ne">RuntimeError</span><span class="p">:</span> <span class="n">Module</span> <span class="s2">&quot;&lt;qudi.hardware.dummy.switch_dummy.SwitchDummy(0x559b9a2c4d70) at 0x7fdc9c0d7ec0&gt;&quot;</span> <span class="n">connected</span> <span class="n">to</span> <span class="n">connector</span> <span class="s2">&quot;streamer&quot;</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">implement</span> <span class="n">interface</span> <span class="s2">&quot;DataInStreamInterface&quot;</span><span class="o">.</span>
</pre></div>
</div>
<p>This is a standard error display, the error is rather explicit, we need a hardware that implements <code class="docutils literal notranslate"><span class="pre">DataInStreamInterface</span></code>!</p>
</section>
<section id="module-not-existing">
<h3>Module not existing<a class="headerlink" href="#module-not-existing" title="Link to this heading">¶</a></h3>
<p>If you try to load a module that does not exist (for example because of a typo), Qudi will be unhappy. For example, if I try to load <code class="docutils literal notranslate"><span class="pre">switches.switch_dummy.SwitchDummy</span></code> (the correct module name would be <code class="docutils literal notranslate"><span class="pre">dummy.switch_dummy.SwitchDummy</span></code>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2025</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">14</span> <span class="mi">18</span><span class="p">:</span><span class="mi">24</span><span class="p">:</span><span class="mi">10</span> <span class="n">error</span> <span class="n">qudi</span><span class="o">.</span><span class="n">Qudi</span> <span class="n">Unhandled</span> <span class="n">qudi</span> <span class="n">exception</span><span class="p">:</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="s2">&quot;[...]/qudi/core/modulemanager.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">208</span><span class="p">,</span> <span class="ow">in</span> <span class="n">activate_module</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_modules</span><span class="p">[</span><span class="n">module_name</span><span class="p">]</span><span class="o">.</span><span class="n">activate</span><span class="p">()</span>
  <span class="n">File</span> <span class="s2">&quot;[...]/qudi/core/modulemanager.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">508</span><span class="p">,</span> <span class="ow">in</span> <span class="n">activate</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_load</span><span class="p">()</span>
  <span class="n">File</span> <span class="s2">&quot;[...]/qudi/core/modulemanager.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">720</span><span class="p">,</span> <span class="ow">in</span> <span class="n">_load</span>
    <span class="n">mod</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;qudi.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_base</span><span class="si">}</span><span class="s1">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_module</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
  <span class="n">File</span> <span class="s2">&quot;[...]/python3.10/importlib/__init__.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">126</span><span class="p">,</span> <span class="ow">in</span> <span class="n">import_module</span>
    <span class="k">return</span> <span class="n">_bootstrap</span><span class="o">.</span><span class="n">_gcd_import</span><span class="p">(</span><span class="n">name</span><span class="p">[</span><span class="n">level</span><span class="p">:],</span> <span class="n">package</span><span class="p">,</span> <span class="n">level</span><span class="p">)</span>
  <span class="n">File</span> <span class="s2">&quot;&lt;frozen importlib._bootstrap&gt;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1050</span><span class="p">,</span> <span class="ow">in</span> <span class="n">_gcd_import</span>
  <span class="n">File</span> <span class="s2">&quot;&lt;frozen importlib._bootstrap&gt;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1027</span><span class="p">,</span> <span class="ow">in</span> <span class="n">_find_and_load</span>
  <span class="n">File</span> <span class="s2">&quot;&lt;frozen importlib._bootstrap&gt;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">992</span><span class="p">,</span> <span class="ow">in</span> <span class="n">_find_and_load_unlocked</span>
  <span class="n">File</span> <span class="s2">&quot;&lt;frozen importlib._bootstrap&gt;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">241</span><span class="p">,</span> <span class="ow">in</span> <span class="n">_call_with_frames_removed</span>
  <span class="n">File</span> <span class="s2">&quot;&lt;frozen importlib._bootstrap&gt;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1050</span><span class="p">,</span> <span class="ow">in</span> <span class="n">_gcd_import</span>
  <span class="n">File</span> <span class="s2">&quot;&lt;frozen importlib._bootstrap&gt;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1027</span><span class="p">,</span> <span class="ow">in</span> <span class="n">_find_and_load</span>
  <span class="n">File</span> <span class="s2">&quot;&lt;frozen importlib._bootstrap&gt;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1004</span><span class="p">,</span> <span class="ow">in</span> <span class="n">_find_and_load_unlocked</span>
<span class="ne">ModuleNotFoundError</span><span class="p">:</span> <span class="n">No</span> <span class="n">module</span> <span class="n">named</span> <span class="s1">&#39;qudi.hardware.switch&#39;</span>
</pre></div>
</div>
<p>Here also, the error is rather explicit, <code class="docutils literal notranslate"><span class="pre">qudi.hardware.switch</span></code> does not exist.</p>
</section>
<section id="yaml-errors">
<h3>YAML errors<a class="headerlink" href="#yaml-errors" title="Link to this heading">¶</a></h3>
<p>YAML is a tricky file format to work with. It is especially fragile to indentation errors, and even experienced developpers can have issues using it.</p>
<figure class="align-default" id="id34">
<a class="reference internal image-reference" href="_images/yaml.jpeg"><img alt="A character is shaking at the thought of writing YAML" src="_images/yaml.jpeg" style="width: 30%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 23 </span><span class="caption-text">The cry of the postdoc condemned to write YAML, circa 2025.</span><a class="headerlink" href="#id34" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>For example, if I sneak <a class="reference external" href="https://en.wikipedia.org/wiki/Tab_key">a tabulation character</a> in my configuration file, Qudi will crash trying to load the file.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2025</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">14</span> <span class="mi">18</span><span class="p">:</span><span class="mi">33</span><span class="p">:</span><span class="mi">31</span> <span class="n">error</span> <span class="n">qudi</span><span class="o">.</span><span class="n">Qudi</span> <span class="n">Invalid</span> <span class="n">qudi</span> <span class="n">configuration</span> <span class="n">file</span> <span class="n">specified</span><span class="o">.</span> <span class="n">Falling</span> <span class="n">back</span> <span class="n">to</span> <span class="n">default</span> <span class="n">config</span><span class="o">.</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="s2">&quot;[...]/qudi/core/application.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">134</span><span class="p">,</span> <span class="ow">in</span> <span class="fm">__init__</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">config_file</span><span class="p">,</span> <span class="n">set_default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
  <span class="n">File</span> <span class="s2">&quot;[...]/qudi/core/config/config.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">157</span><span class="p">,</span> <span class="ow">in</span> <span class="n">load</span>
    <span class="n">config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
  <span class="n">File</span> <span class="s2">&quot;[...]/qudi/core/config/file_handler.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">42</span><span class="p">,</span> <span class="ow">in</span> <span class="n">_load</span>
    <span class="k">return</span> <span class="n">yaml_load</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">_relative_to_absolute_path</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
  <span class="n">File</span> <span class="s2">&quot;[...]/qudi/util/yaml.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">260</span><span class="p">,</span> <span class="ow">in</span> <span class="n">yaml_load</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">YAML</span><span class="p">()</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
  <span class="n">File</span> <span class="s2">&quot;[...]/ruamel/yaml/main.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">453</span><span class="p">,</span> <span class="ow">in</span> <span class="n">load</span>
    <span class="k">return</span> <span class="n">constructor</span><span class="o">.</span><span class="n">get_single_data</span><span class="p">()</span>
  <span class="n">File</span> <span class="s2">&quot;[...]/ruamel/yaml/constructor.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">117</span><span class="p">,</span> <span class="ow">in</span> <span class="n">get_single_data</span>
    <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">composer</span><span class="o">.</span><span class="n">get_single_node</span><span class="p">()</span>
  <span class="n">File</span> <span class="s2">&quot;_ruamel_yaml.pyx&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">706</span><span class="p">,</span> <span class="ow">in</span> <span class="n">ruamel</span><span class="o">.</span><span class="n">yaml</span><span class="o">.</span><span class="n">clib</span><span class="o">.</span><span class="n">_ruamel_yaml</span><span class="o">.</span><span class="n">CParser</span><span class="o">.</span><span class="n">get_single_node</span>
  <span class="n">File</span> <span class="s2">&quot;_ruamel_yaml.pyx&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">724</span><span class="p">,</span> <span class="ow">in</span> <span class="n">ruamel</span><span class="o">.</span><span class="n">yaml</span><span class="o">.</span><span class="n">clib</span><span class="o">.</span><span class="n">_ruamel_yaml</span><span class="o">.</span><span class="n">CParser</span><span class="o">.</span><span class="n">_compose_document</span>
  <span class="n">File</span> <span class="s2">&quot;_ruamel_yaml.pyx&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">775</span><span class="p">,</span> <span class="ow">in</span> <span class="n">ruamel</span><span class="o">.</span><span class="n">yaml</span><span class="o">.</span><span class="n">clib</span><span class="o">.</span><span class="n">_ruamel_yaml</span><span class="o">.</span><span class="n">CParser</span><span class="o">.</span><span class="n">_compose_node</span>
  <span class="n">File</span> <span class="s2">&quot;_ruamel_yaml.pyx&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">889</span><span class="p">,</span> <span class="ow">in</span> <span class="n">ruamel</span><span class="o">.</span><span class="n">yaml</span><span class="o">.</span><span class="n">clib</span><span class="o">.</span><span class="n">_ruamel_yaml</span><span class="o">.</span><span class="n">CParser</span><span class="o">.</span><span class="n">_compose_mapping_node</span>
  <span class="n">File</span> <span class="s2">&quot;_ruamel_yaml.pyx&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">775</span><span class="p">,</span> <span class="ow">in</span> <span class="n">ruamel</span><span class="o">.</span><span class="n">yaml</span><span class="o">.</span><span class="n">clib</span><span class="o">.</span><span class="n">_ruamel_yaml</span><span class="o">.</span><span class="n">CParser</span><span class="o">.</span><span class="n">_compose_node</span>
  <span class="n">File</span> <span class="s2">&quot;_ruamel_yaml.pyx&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">889</span><span class="p">,</span> <span class="ow">in</span> <span class="n">ruamel</span><span class="o">.</span><span class="n">yaml</span><span class="o">.</span><span class="n">clib</span><span class="o">.</span><span class="n">_ruamel_yaml</span><span class="o">.</span><span class="n">CParser</span><span class="o">.</span><span class="n">_compose_mapping_node</span>
  <span class="n">File</span> <span class="s2">&quot;_ruamel_yaml.pyx&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">775</span><span class="p">,</span> <span class="ow">in</span> <span class="n">ruamel</span><span class="o">.</span><span class="n">yaml</span><span class="o">.</span><span class="n">clib</span><span class="o">.</span><span class="n">_ruamel_yaml</span><span class="o">.</span><span class="n">CParser</span><span class="o">.</span><span class="n">_compose_node</span>
  <span class="n">File</span> <span class="s2">&quot;_ruamel_yaml.pyx&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">889</span><span class="p">,</span> <span class="ow">in</span> <span class="n">ruamel</span><span class="o">.</span><span class="n">yaml</span><span class="o">.</span><span class="n">clib</span><span class="o">.</span><span class="n">_ruamel_yaml</span><span class="o">.</span><span class="n">CParser</span><span class="o">.</span><span class="n">_compose_mapping_node</span>
  <span class="n">File</span> <span class="s2">&quot;_ruamel_yaml.pyx&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">775</span><span class="p">,</span> <span class="ow">in</span> <span class="n">ruamel</span><span class="o">.</span><span class="n">yaml</span><span class="o">.</span><span class="n">clib</span><span class="o">.</span><span class="n">_ruamel_yaml</span><span class="o">.</span><span class="n">CParser</span><span class="o">.</span><span class="n">_compose_node</span>
  <span class="n">File</span> <span class="s2">&quot;_ruamel_yaml.pyx&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">891</span><span class="p">,</span> <span class="ow">in</span> <span class="n">ruamel</span><span class="o">.</span><span class="n">yaml</span><span class="o">.</span><span class="n">clib</span><span class="o">.</span><span class="n">_ruamel_yaml</span><span class="o">.</span><span class="n">CParser</span><span class="o">.</span><span class="n">_compose_mapping_node</span>
  <span class="n">File</span> <span class="s2">&quot;_ruamel_yaml.pyx&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">904</span><span class="p">,</span> <span class="ow">in</span> <span class="n">ruamel</span><span class="o">.</span><span class="n">yaml</span><span class="o">.</span><span class="n">clib</span><span class="o">.</span><span class="n">_ruamel_yaml</span><span class="o">.</span><span class="n">CParser</span><span class="o">.</span><span class="n">_parse_next_event</span>
<span class="n">ruamel</span><span class="o">.</span><span class="n">yaml</span><span class="o">.</span><span class="n">scanner</span><span class="o">.</span><span class="n">ScannerError</span><span class="p">:</span> <span class="k">while</span> <span class="n">scanning</span> <span class="k">for</span> <span class="n">the</span> <span class="nb">next</span> <span class="n">token</span>
<span class="n">found</span> <span class="n">character</span> <span class="n">that</span> <span class="n">cannot</span> <span class="n">start</span> <span class="nb">any</span> <span class="n">token</span>
  <span class="ow">in</span> <span class="s2">&quot;/home/klafyvel/Documents/qudi-lab-on-a-molecule-modules/exercise_1.cfg&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">24</span><span class="p">,</span> <span class="n">column</span> <span class="mi">5</span>
</pre></div>
</div>
<p>As you can see, the error tells me which line and column are offending.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>To avoid issues with tabulation characters, I advise configuring your text editor to make it automatically replace tabulation characters by four spaces.</p>
</div>
<p>To avoid having to deal with YAML, Qudi provides an experimental graphical editor for configuration files, accessible from the main window. The interface is rather explicit, and you can try to play with it if you are curious.</p>
<figure class="align-default" id="id35">
<a class="reference internal image-reference" href="_images/config_editor.png"><img alt="_images/config_editor.png" src="_images/config_editor.png" style="width: 70%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 24 </span><span class="caption-text">The experimental configuration editor.</span><a class="headerlink" href="#id35" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</section>
</section>
<section id="connectivity-errors">
<h2>Connectivity errors<a class="headerlink" href="#connectivity-errors" title="Link to this heading">¶</a></h2>
<p>I briefly mentionned in the section on configuration the existence of <a class="reference external" href="https://ulm-iqo.github.io/qudi-core/design_concepts/remote_modules.html">remote modules</a>. Connectivity error can also concern local modules. You will obviously encouter errors if the hardware you are trying to access is not connected. An error that I have often seen in the lab is having multiple Qudi instances running. This is often due to people thinking they closed a previous instance of Qudi by clicking on the red cross on the top-right of the main window. This does not close Qudi and can lead to errors. Close Qudi instances by using the <kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">File</kbd> <kbd class="kbd docutils literal notranslate">&gt;</kbd> <kbd class="kbd docutils literal notranslate">Quit</kbd> <kbd class="kbd docutils literal notranslate">qudi</kbd></kbd> menu in the main window preferably, or by closing the terminal in case QUdi crashed (but be aware that this is an extreme measure, and will not go through the usual extinction procedure).</p>
<figure class="align-default" id="id36">
<a class="reference internal image-reference" href="_images/too_many_qudi.jpeg"><img alt="A character has been submersed by little Qudi logos. only his thumb up is emerging." src="_images/too_many_qudi.jpeg" style="width: 30%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 25 </span><span class="caption-text">Multiple Qudi instances running in parallel will interfere with one another.</span><a class="headerlink" href="#id36" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>It is probably rather clear why when the network is not working, you might have errors if you rely on it! To diagnose this kind of problems, you might try to visit a website if your network is supposed to be connected to the internet, verify that ethernet cables are connected, etc. Note that when you connect to a Qudi instance running on another computer, there might be issues when Qudi is closed on the main computer but is kept running on the remote computer. One solution is to close both Qudi instances, then starting the remote Qudi instance and finally the local Qudi instance.</p>
<figure class="align-default" id="id37">
<a class="reference internal image-reference" href="_images/network_failure.jpeg"><img alt="A character is perplexed by a knot of ethernet cables." src="_images/network_failure.jpeg" style="width: 30%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 26 </span><span class="caption-text">If you rely on hardware accessed through the network, you are dependent on the network working.</span><a class="headerlink" href="#id37" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</section>
<section id="coding-errors">
<h2>Coding errors<a class="headerlink" href="#coding-errors" title="Link to this heading">¶</a></h2>
<p>Although a lot of care has been put in the source code of the modules we use, we do encouter bugs from time to time. A smoking gun is typically Python errors originating from the source code.</p>
<figure class="align-default">
<a class="reference internal image-reference" href="_images/a_bug.jpeg"><img alt="A character is perplexed by a giant insect." src="_images/a_bug.jpeg" style="width: 30%;" />
</a>
</figure>
<p>For example, if I sneak a <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">/</span> <span class="pre">0</span></code> in the <code class="docutils literal notranslate"><span class="pre">on_activate</span></code> method of a module, I will get two errors.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>2025-12-14 19:24:21 error qudi.hardware.dummy.data_instream_dummy.InStreamDummy Exception during activation:
Traceback (most recent call last):
  File &quot;[...]/qudi/core/module.py&quot;, line 309, in __activation_callback
    self.on_activate()
  File &quot;[...]/src/qudi/hardware/dummy/data_instream_dummy.py&quot;, line 313, in on_activate
    1 / 0
ZeroDivisionError: division by zero
2025-12-14 19:24:21 error qudi.Qudi Unable to activate autostart module &quot;time_series_gui&quot;:
Traceback (most recent call last):
  File &quot;[...]/qudi/core/modulemanager.py&quot;, line 569, in activate
    self._instance.module_state.activate()
  File &quot;[...]/fysom/__init__.py&quot;, line 299, in fn
    raise Canceled(
fysom.Canceled: Cannot trigger event activate because the onbeforeactivate handler returns False

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File &quot;[...]/qudi/core/application.py&quot;, line 292, in _start_startup_modules
    self.module_manager.activate_module(module)
  File &quot;[...]/qudi/core/modulemanager.py&quot;, line 208, in activate_module
    self._modules[module_name].activate()
  File &quot;[...]/qudi/core/modulemanager.py&quot;, line 540, in activate
    module.activate()
  File &quot;[...]/qudi/core/modulemanager.py&quot;, line 540, in activate
    module.activate()
  File &quot;[...]/qudi/core/modulemanager.py&quot;, line 571, in activate
    raise RuntimeError(f&#39;Failed to activate {self.module_base} module &quot;{self.name}&quot;!&#39;) from e
RuntimeError: Failed to activate hardware module &quot;instream_dummy&quot;!
</pre></div>
</div>
<p>The second error corresponds to the GUI module failing to initialize because of another error, that corresponds to the module manager of Qudi failing to initialize the fake hardware module, which I tempered with. The first error is the actual error I introduced. Here the error is quite explicit, we have a division by zero and Python tells us where this occured.</p>
<p>A very common programmation bug is one that we already encountered in the <a class="reference internal" href="#scripting"><span class="std std-ref">Scripting Qudi using Jupyter notebooks</span></a> section. When dealing with complex objects, typically Numpy arrays, obtained over the network, <code class="docutils literal notranslate"><span class="pre">netobtain</span></code> statements might be mising.</p>
</section>
<section id="i-have-found-an-error-what-do-i-do">
<h2>I have found an error, what do I do?<a class="headerlink" href="#i-have-found-an-error-what-do-i-do" title="Link to this heading">¶</a></h2>
<p>We spent a good amount of time exploring some Qudi errors. Where do we go from there?</p>
<section id="trying-to-fix-it-yourself">
<h3>Trying to fix it yourself<a class="headerlink" href="#trying-to-fix-it-yourself" title="Link to this heading">¶</a></h3>
<p>An appealing solution is to be able to fix the error by yourself. Some strategies include:</p>
<ul class="simple">
<li><p>Finding a solution from the error message,</p></li>
<li><p>Restarting Qudi,</p></li>
<li><p>Clearing status variables: remember that they store the internal state between different runs of Qudi. Unfortunately, this can involve corrupted states. Check the <a class="reference internal" href="#status-variables"><span class="std std-ref">Status variables</span></a> section if you are unsure how to proceed.</p></li>
</ul>
</section>
<section id="documenting-the-error">
<h3>Documenting the error<a class="headerlink" href="#documenting-the-error" title="Link to this heading">¶</a></h3>
<p>Wether or not you are able to fix the issue yourself, it is useful to document it.</p>
<ol class="arabic simple">
<li><p>Collect as much information on the error as you can. This includes the procedure to reproduce the error, the error message(s), screenshots, log files, any observation you can have on the situation (<em>use your experimentalist feelings!</em>)</p></li>
<li><p><strong>Write it down</strong>, for example in a labbook. It is best if the procedure is standardized in your group.</p></li>
</ol>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Please, include the error messages <strong>as text</strong>. A screenshot of an error message is very impractical to work with because it can be hard to read and it is not searchable easily. Taking a picture of the screen with your phone is even worse because it potentially add a Moiré pattern on the image. :(</p>
</div>
</section>
<section id="finding-help">
<h3>Finding help<a class="headerlink" href="#finding-help" title="Link to this heading">¶</a></h3>
<p>Once you have an error well documented, and if you are not able to fix it yourself, you are ready to look for help.</p>
<ul class="simple">
<li><p>Check the documentation,</p></li>
<li><p>Ask your colleagues,</p></li>
<li><p>You can also use <a class="reference external" href="https://github.com/Ulm-IQO/qudi-core/discussions">the official Qudi forum</a>.</p></li>
</ul>
<p>Asking for help is not necessarily easy, especially if you are not used to do that. As you will likely ask for help via text, you might be interested in these guides for asking help on computer-related problems:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://xyproblem.info/">The XY problem</a></p></li>
<li><p><a class="reference external" href="https://stackoverflow.com/help/how-to-ask">Stackoverflow: how do I ask a good question?</a></p></li>
<li><p><a class="reference external" href="http://catb.org/~esr/faqs/smart-questions.html">How To Ask Questions The Smart Way</a></p></li>
</ul>
</section>
</section>
</section>
<section id="interactive-activity-let-s-write-a-logic-module">
<h1>Interactive activity: let’s write a logic module<a class="headerlink" href="#interactive-activity-let-s-write-a-logic-module" title="Link to this heading">¶</a></h1>
<p>The goal of this interactive section is to make you manipulate many aspects of Qudi. We will write a logic module and make it do several common actions. The final logic will be completely useless, but hopefully the different steps involved will be useful to make you understand the mechanisms involved.</p>
<p>This is thought as a challenge with increasing levels of difficulty. The higher levels depend on you successfully clearing the lower levels. If you complete level 4, your name should appear on the tableboard!</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you are reading the notes without following the lecture, level 4 will be difficult (you need a specific logic running on another computer of the network). You can try nonetheless and contact me so we try together your solution, or try to setup the ranking logic on another computer and run it by yourself!</p>
</div>
<section id="level-0-let-s-not-write-a-logic-module">
<h2>Level 0: Let’s <strong>not</strong> write a logic module<a class="headerlink" href="#level-0-let-s-not-write-a-logic-module" title="Link to this heading">¶</a></h2>
<p>Use the notebook to query the dummy hardware.</p>
</section>
<section id="level-1-a-simple-logic-module-that-reads-values-and-print-them-in-the-logs">
<h2>Level 1: A simple logic module that reads values and print them in the logs<a class="headerlink" href="#level-1-a-simple-logic-module-that-reads-values-and-print-them-in-the-logs" title="Link to this heading">¶</a></h2>
</section>
<section id="level-2-saving-data-to-a-file">
<h2>Level 2: Saving data to a file<a class="headerlink" href="#level-2-saving-data-to-a-file" title="Link to this heading">¶</a></h2>
</section>
<section id="level-3-leveraging-the-qdplot-logic-to-display-data">
<h2>Level 3: Leveraging the QDPlot logic to display data!<a class="headerlink" href="#level-3-leveraging-the-qdplot-logic-to-display-data" title="Link to this heading">¶</a></h2>
</section>
<section id="level-4-what-data-can-i-find-from-my-neighbor-s-computer">
<h2>Level 4: What data can I find from my neighbor’s computer?<a class="headerlink" href="#level-4-what-data-can-i-find-from-my-neighbor-s-computer" title="Link to this heading">¶</a></h2>
</section>
</section>
<section id="the-modules-we-commonly-use">
<h1>The modules we commonly use<a class="headerlink" href="#the-modules-we-commonly-use" title="Link to this heading">¶</a></h1>
<p>In this section we are going to go through some common modules, especially user interfaces, that we use for single molecule applications. Please load the <code class="docutils literal notranslate"><span class="pre">default.cfg</span></code> configuration and restart Qudi.</p>
<section id="the-time-series-gui">
<h2>The time series GUI<a class="headerlink" href="#the-time-series-gui" title="Link to this heading">¶</a></h2>
<p>The GUI that we have been using the most during this lecture is the time series GUI. It is rather simple, reliable, and always useful. It is worth describing a bit some of its functionalities. This GUI and the corresponding <code class="docutils literal notranslate"><span class="pre">TimeSeriesReaderLogic</span></code> deal with hardwares implementing the <code class="docutils literal notranslate"><span class="pre">DataInStreamInterface</span></code>. They also calculate moving averages of the acquired signals.</p>
<figure class="align-default" id="id38">
<a class="reference internal image-reference" href="_images/time_series_illustration.svg"><img alt="_images/time_series_illustration.svg" src="_images/time_series_illustration.svg" style="width: 100%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 27 </span><span class="caption-text">The main time series window. Your (mostly) reliable best friend.</span><a class="headerlink" href="#id38" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>Going from left to right and top to bottom in the previous figure, we have:</p>
<ul class="simple">
<li><p>The start/stop button, that… starts and stop the acquisition,</p></li>
<li><p>The start/stop recording data, that will start recording a running acquisition for as long as you want,</p></li>
<li><p>The take snapshot button. Did you see something interesting in the data trace but forgot to start the acquisition? quick! press this button!</p></li>
<li><p>The freeze autoscaling of the Y axis button. This is an addition we made to the original Ulm IQO GUI to tame a bit the autoscaling. It is useful for example in situations where you are aligning on a weak signal, but have some strong signals that can come and parasite the data trace.</p></li>
<li><p>The trace view selection and channel settings buttons, that open the corresponding setting windows that we detail below.</p></li>
<li><p>The curent value channel combo box, that controls which measured value is being displayed.</p></li>
<li><p>The trace length spin box, which controls how long the stored data are.</p></li>
<li><p>The data rate spin box, which controls the data rate of the trace being displayed.</p></li>
<li><p>The oversampling factor, which controls how much faster the hardware is acquiring data.</p></li>
<li><p>The moving average width, which controls how many data points are used for calculating moving averages.</p></li>
</ul>
<p>There are two important control points that can be called using the trace view selection and channel settings buttons. The first one is the trace view window. It only controls what is being <strong>displayed</strong> in the window. The data that are hidden are still being acquired and will be saved to file if you request that.</p>
<figure class="align-default" id="id39">
<a class="reference internal image-reference" href="_images/trace_view_selection.png"><img alt="_images/trace_view_selection.png" src="_images/trace_view_selection.png" style="width: 40%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 28 </span><span class="caption-text">The trace view window.</span><a class="headerlink" href="#id39" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>The second control point is the channel settings window. It controls what data are actually being acquired. It is not accessible when data acquisition is running.</p>
<figure class="align-default" id="id40">
<a class="reference internal image-reference" href="_images/data_channel_settings.png"><img alt="_images/data_channel_settings.png" src="_images/data_channel_settings.png" style="width: 40%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 29 </span><span class="caption-text">The channel settings window.</span><a class="headerlink" href="#id40" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When performing alignement, it is sometimes useful to disable moving average acquisition. Indeed, calculating the moving average introduces a temporal lag in what is being displayed which can be annoying when aligning.</p>
</div>
<p>For an example of how to set-up the time series reader, please refer to <a class="reference external" href="https://lab-on-a-molecule-quantum-nanophotonics.github.io/qudi-lab-on-a-molecule-modules/iqo-docs/setup_timeseries.html">the guide on time series</a>.</p>
</section>
<section id="the-scanner-gui-running-confocal-scans-and-controlling-the-galvo-mirror">
<h2>The scanner GUI: running confocal scans and controlling the galvo mirror<a class="headerlink" href="#the-scanner-gui-running-confocal-scans-and-controlling-the-galvo-mirror" title="Link to this heading">¶</a></h2>
<p>If you do confocal microscopy, this setup is very useful. It allows scanning the sample plane in as many dimensions as are available and optimizing on punctual sources.</p>
<figure class="align-default" id="id41">
<a class="reference internal image-reference" href="_images/scanner_gui_annotated.svg"><img alt="_images/scanner_gui_annotated.svg" src="_images/scanner_gui_annotated.svg" style="width: 100%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 30 </span><span class="caption-text">The Scanner GUI. Available axes may vary.</span><a class="headerlink" href="#id41" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>This window includes many features. You can scan pairs of axes, or axes alone. You can navigate through the history of scans (this will also move the cursor to the saved position). Finally, you can also move the position manually and use the automatic optimization feature to get the best position on a punctual emitter. Some notes on the features:</p>
<ul class="simple">
<li><p>You can add tags to the saved file names,</p></li>
<li><p>The amplitude of the movements of the cursor (the green cross) depends on the level of zoom. If you want to perform precise movements, zoom-in!</p></li>
<li><p>There is a tilt-correction feature where you specify three points that you know for sure are in focus, and the logic tries to correct the movements so that planar movements are parallel to the sample surface.</p></li>
<li><p>The optimizer is very useful, and also very dumb. I will fit 2D or 1D Gaussians successively and go to the maximum, whatever the result of the fit is. This means that when you work in low signal situations, you are at risk of losing your position. Be ready to jump on the stop button before it goes crazy!</p></li>
</ul>
<p>If you are interested in setting up confocal scanning, have a look at <a class="reference external" href="https://lab-on-a-molecule-quantum-nanophotonics.github.io/qudi-lab-on-a-molecule-modules/iqo-docs/setup_confocal_scanning.html">the guide on confocal scanning</a>.</p>
</section>
<section id="the-national-instruments-hardwares-and-their-configurations">
<h2>The National Instruments hardwares and their configurations<a class="headerlink" href="#the-national-instruments-hardwares-and-their-configurations" title="Link to this heading">¶</a></h2>
<p>One of the best handled piece of hardware in Qudi are the National Instruments DAQ cards. This is probably due to historical reasons and their widespread use in fields doing confocal micrsocopy. There are no less than 4 hardware modules that can deal with them. Some notes:
*</p>
<p>Probably not covered during the in-person lecture, but useful to explain some things (io vs input hardware modules, what you can and cannot do, wxplain a bit how the ports are named)</p>
</section>
<section id="laser-scanners">
<h2>Laser scanners<a class="headerlink" href="#laser-scanners" title="Link to this heading">¶</a></h2>
<p>Here we go quickly over the logic of the laser scanner through their state machines. Give some illustrations and explanations of why they do certain things.</p>
<section id="the-laser-scanner-user-interface">
<h3>The laser scanner user interface<a class="headerlink" href="#the-laser-scanner-user-interface" title="Link to this heading">¶</a></h3>
<figure class="align-default" id="id42">
<a class="reference internal image-reference" href="_images/laser_window_annotated.svg"><img alt="_images/laser_window_annotated.svg" src="_images/laser_window_annotated.svg" style="width: 70%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 31 </span><span class="caption-text">The laser scanner user interface</span><a class="headerlink" href="#id42" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>Explain that this interface is generic, and that the middle column changes for each laser. Explain notes, and scanner status. Explain the data pane, with how the fit region works, the fit button also. Explain how to control the idle value of the laser, <strong>that the <code class="docutils literal notranslate"><span class="pre">Laser</span> <span class="pre">follow</span> <span class="pre">cursor</span></code> switch needs to be enabled</strong>, the drag and drop of the green line, the slider and its scroll divider.</p>
</section>
<section id="hardwares-and-state-machines">
<h3>Hardwares and State machines<a class="headerlink" href="#hardwares-and-state-machines" title="Link to this heading">¶</a></h3>
<p>Reminder of state machines, use the dummy hardware to illustrate</p>
<figure class="align-default" id="id43">
<a class="reference internal image-reference" href="_images/qudi.hardware.dummy.excitation_scanner_dummy.ExcitationScannerDummy.svg"><img alt="_images/qudi.hardware.dummy.excitation_scanner_dummy.ExcitationScannerDummy.svg" src="_images/qudi.hardware.dummy.excitation_scanner_dummy.ExcitationScannerDummy.svg" style="width: 60%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 32 </span><span class="caption-text">The state machine of the dummy laser. On the right the simplified version without the interuption routines.</span><a class="headerlink" href="#id43" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<section id="an-example-state-machine-the-dfb-laser">
<h4>An example state machine: the DFB laser<a class="headerlink" href="#an-example-state-machine-the-dfb-laser" title="Link to this heading">¶</a></h4>
<p>Nothing really interesting to comment on here, we can just go fast on that.</p>
<figure class="align-default" id="id44">
<a class="reference internal image-reference" href="_images/qudi.hardware.interfuse.finite_sampling_scanning_excitation.FiniteSamplingScanningExcitationInterfuse.svg"><img alt="_images/qudi.hardware.interfuse.finite_sampling_scanning_excitation.FiniteSamplingScanningExcitationInterfuse.svg" src="_images/qudi.hardware.interfuse.finite_sampling_scanning_excitation.FiniteSamplingScanningExcitationInterfuse.svg" style="width: 60%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 33 </span><span class="caption-text">The state machine for the DFB laser. On the right, the simplified version with the interuption transition and the stopped state removed.</span><a class="headerlink" href="#id44" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</section>
<section id="a-slightly-more-complicated-example-the-moglabs-cem-laser">
<h4>A slightly more complicated example: the Moglabs CEM laser<a class="headerlink" href="#a-slightly-more-complicated-example-the-moglabs-cem-laser" title="Link to this heading">¶</a></h4>
<p>Explain why we have a scan_idle state</p>
<figure class="align-default" id="id45">
<a class="reference internal image-reference" href="_images/qudi.hardware.interfuse.moglabs_scanning_excitation.FiniteSamplingScanningExcitationInterfuse.svg"><img alt="_images/qudi.hardware.interfuse.moglabs_scanning_excitation.FiniteSamplingScanningExcitationInterfuse.svg" src="_images/qudi.hardware.interfuse.moglabs_scanning_excitation.FiniteSamplingScanningExcitationInterfuse.svg" style="width: 60%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 34 </span><span class="caption-text">The state machine for the Moglabls CEM laser. On the right, the simplified version with the interruption transitions and the stopped state removed.</span><a class="headerlink" href="#id45" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</section>
<section id="a-more-complicated-example-the-matisse-laser">
<h4>A more complicated example: the Matisse laser<a class="headerlink" href="#a-more-complicated-example-the-matisse-laser" title="Link to this heading">¶</a></h4>
<p>Detail a bit more, explain that the matisse laser is in two part, one on the laser’s computer, not shown here, and one on the main computer.</p>
<figure class="align-default" id="id46">
<a class="reference internal image-reference" href="_images/qudi.hardware.interfuse.remote_matisse_scanner.RemoteMatisseScanner.svg"><img alt="_images/qudi.hardware.interfuse.remote_matisse_scanner.RemoteMatisseScanner.svg" src="_images/qudi.hardware.interfuse.remote_matisse_scanner.RemoteMatisseScanner.svg" style="width: 60%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 35 </span><span class="caption-text">The state machine for the Matisse laser. On the right, the simplified version where the interruption transitions and the stopped state have been removed.</span><a class="headerlink" href="#id46" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</section>
</section>
</section>
<section id="the-laser-scanner-logic">
<h2>The laser scanner logic<a class="headerlink" href="#the-laser-scanner-logic" title="Link to this heading">¶</a></h2>
<p>Probably not covered in the in-person lecture, give some insights on how the logic works and what are some interesting control points for it.</p>
</section>
<section id="laser-specifics-dfb-laser">
<h2>Laser specifics: DFB laser<a class="headerlink" href="#laser-specifics-dfb-laser" title="Link to this heading">¶</a></h2>
<p>Explain that the DFB laser is controlld by a very generic hardware interfuse (essentially we use a NI instrument-like hardware), and that it can in addition control a <code class="docutils literal notranslate"><span class="pre">ControlSetpointInterface</span></code> (for example the cryo). That for simplicity we have two available configurations in 66.</p>
<figure class="align-default" id="id47">
<a class="reference internal image-reference" href="_images/5d3c2a5f-415a-40ae-bd7e-aa280971513f.png"><img alt="_images/5d3c2a5f-415a-40ae-bd7e-aa280971513f.png" src="_images/5d3c2a5f-415a-40ae-bd7e-aa280971513f.png" style="width: 60%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 36 </span><span class="caption-text">The DFB can have an external control hardware connected. For simplicity in Lab 66 we have two corresponding configurations available</span><a class="headerlink" href="#id47" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>Discuss a bit the control of the cryo, also that the temperature get saved as a global metadata!</p>
<figure class="align-default" id="id48">
<a class="reference internal image-reference" href="_images/ce06e35a-71d8-420d-88bb-e134a2f325f7.png"><img alt="_images/ce06e35a-71d8-420d-88bb-e134a2f325f7.png" src="_images/ce06e35a-71d8-420d-88bb-e134a2f325f7.png" style="width: 60%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 37 </span><span class="caption-text">Don’t forget to click on <kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">ENABLE</kbd> <kbd class="kbd docutils literal notranslate">EXTERNAL</kbd> <kbd class="kbd docutils literal notranslate">CONTROL</kbd></kbd> in the Cryostation software if you are using the dfb with the cryo.</span><a class="headerlink" href="#id48" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</section>
</section>
<section id="pulsers">
<h1>Pulsers<a class="headerlink" href="#pulsers" title="Link to this heading">¶</a></h1>
<p>Maybe skip that, and include in the documentation my research notebook to understand how it works.</p>
</section>
<section id="concluding-remarks">
<h1>Concluding remarks<a class="headerlink" href="#concluding-remarks" title="Link to this heading">¶</a></h1>
</section>


          </div>
          <div class="page-nav">
            <div class="inner"><ul class="page-nav">
  <li class="prev">
    <a href="index.html"
       title="previous chapter">← Qudi Lab on a Molecule Modules documentation</a>
  </li>
  <li class="next">
    <a href="guides/excitation-spectroscopy.html"
       title="next chapter">Guide: performing excitation spectroscopy →</a>
  </li>
</ul><div class="footer" role="contentinfo">
      &#169; Copyright 2025, Molecular Quantum Nanophotonics Lab @ LENS.
    <br>
    Created using <a href="http://sphinx-doc.org/">Sphinx</a> 8.1.3 with <a href="https://github.com/schettino72/sphinx_press_theme">Press Theme</a> 0.9.1.
</div>
            </div>
          </div>
      </page>
    </div></div>
    
    
  </body>
</html>